<!DOCTYPE html>
<!-- Generated by pkgdown: do not edit by hand --><html lang="en">
<head>
<meta http-equiv="Content-Type" content="text/html; charset=UTF-8">
<meta charset="utf-8">
<meta http-equiv="X-UA-Compatible" content="IE=edge">
<meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">
<meta name="description" content="plot.matrix">
<title>`r sprintf('plot.matrix v%s', packageVersion('plot.matrix'))` • plot.matrix</title>
<script src="../deps/jquery-3.6.0/jquery-3.6.0.min.js"></script><meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">
<link href="../deps/bootstrap-5.1.3/bootstrap.min.css" rel="stylesheet">
<script src="../deps/bootstrap-5.1.3/bootstrap.bundle.min.js"></script><!-- Font Awesome icons --><link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.12.1/css/all.min.css" integrity="sha256-mmgLkCYLUQbXn0B1SRqzHar6dCnv9oZFPEC1g1cwlkk=" crossorigin="anonymous">
<link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.12.1/css/v4-shims.min.css" integrity="sha256-wZjR52fzng1pJHwx4aV2AO3yyTOXrcDW7jBpJtTwVxw=" crossorigin="anonymous">
<!-- bootstrap-toc --><script src="https://cdn.rawgit.com/afeld/bootstrap-toc/v1.0.1/dist/bootstrap-toc.min.js"></script><!-- headroom.js --><script src="https://cdnjs.cloudflare.com/ajax/libs/headroom/0.11.0/headroom.min.js" integrity="sha256-AsUX4SJE1+yuDu5+mAVzJbuYNPHj/WroHuZ8Ir/CkE0=" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/headroom/0.11.0/jQuery.headroom.min.js" integrity="sha256-ZX/yNShbjqsohH1k95liqY9Gd8uOiE1S4vZc+9KQ1K4=" crossorigin="anonymous"></script><!-- clipboard.js --><script src="https://cdnjs.cloudflare.com/ajax/libs/clipboard.js/2.0.6/clipboard.min.js" integrity="sha256-inc5kl9MA1hkeYUt+EC3BhlIgyp/2jDIyBLS6k3UxPI=" crossorigin="anonymous"></script><!-- search --><script src="https://cdnjs.cloudflare.com/ajax/libs/fuse.js/6.4.6/fuse.js" integrity="sha512-zv6Ywkjyktsohkbp9bb45V6tEMoWhzFzXis+LrMehmJZZSys19Yxf1dopHx7WzIKxr5tK2dVcYmaCk2uqdjF4A==" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/autocomplete.js/0.38.0/autocomplete.jquery.min.js" integrity="sha512-GU9ayf+66Xx2TmpxqJpliWbT5PiGYxpaG8rfnBEk1LL8l1KGkRShhngwdXK1UgqhAzWpZHSiYPc09/NwDQIGyg==" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/mark.js/8.11.1/mark.min.js" integrity="sha512-5CYOlHXGh6QpOFA/TeTylKLWfB3ftPsde7AnmhuitiTX4K5SqCLBeKro6sPS8ilsz1Q4NRx3v8Ko2IBiszzdww==" crossorigin="anonymous"></script><!-- pkgdown --><script src="../pkgdown.js"></script><meta property="og:title" content="`r sprintf('plot.matrix v%s', packageVersion('plot.matrix'))`">
<meta property="og:description" content="plot.matrix">
<!-- mathjax --><script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/MathJax.js" integrity="sha256-nvJJv9wWKEm88qvoQl9ekL2J+k/RWIsaSScxxlsrv8k=" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/config/TeX-AMS-MML_HTMLorMML.js" integrity="sha256-84DKXVJXs0/F8OTMzX4UR909+jtl4G7SPypPavF+GfA=" crossorigin="anonymous"></script><!--[if lt IE 9]>
<script src="https://oss.maxcdn.com/html5shiv/3.7.3/html5shiv.min.js"></script>
<script src="https://oss.maxcdn.com/respond/1.4.2/respond.min.js"></script>
<![endif]-->
</head>
<body>
    <a href="#main" class="visually-hidden-focusable">Skip to contents</a>
    

    <nav class="navbar fixed-top navbar-light navbar-expand-lg bg-light"><div class="container">
    
    <a class="navbar-brand me-2" href="../index.html">plot.matrix</a>

    <small class="nav-text text-muted me-auto" data-bs-toggle="tooltip" data-bs-placement="bottom" title="">1.6.2</small>

    
    <button class="navbar-toggler" type="button" data-bs-toggle="collapse" data-bs-target="#navbar" aria-controls="navbar" aria-expanded="false" aria-label="Toggle navigation">
      <span class="navbar-toggler-icon"></span>
    </button>

    <div id="navbar" class="collapse navbar-collapse ms-3">
      <ul class="navbar-nav me-auto">
<li class="nav-item">
  <a class="nav-link" href="../reference/index.html">Reference</a>
</li>
<li class="active nav-item dropdown">
  <a href="#" class="nav-link dropdown-toggle" data-bs-toggle="dropdown" role="button" aria-expanded="false" aria-haspopup="true" id="dropdown-articles">Articles</a>
  <div class="dropdown-menu" aria-labelledby="dropdown-articles">
    <a class="dropdown-item" href="../articles/Example_Analysis.html">Example Analysis</a>
    <a class="dropdown-item" href="../articles/plot.matrix.html">`r sprintf('plot.matrix v%s', packageVersion('plot.matrix'))`</a>
  </div>
</li>
      </ul>
<form class="form-inline my-2 my-lg-0" role="search">
        <input type="search" class="form-control me-sm-2" aria-label="Toggle navigation" name="search-input" data-search-index="../search.json" id="search-input" placeholder="Search for" autocomplete="off">
</form>

      <ul class="navbar-nav">
<li class="nav-item">
  <a class="external-link nav-link" href="https://github.com/sigbertklinke/plot.matrix/" aria-label="github">
    <span class="fab fa fab fa-github fa-lg"></span>
     
  </a>
</li>
      </ul>
</div>

    
  </div>
</nav><div class="container template-article">




<div class="row">
  <main id="main" class="col-md-9"><div class="page-header">
      <img src="" class="logo" alt=""><h1>`r sprintf('plot.matrix v%s', packageVersion('plot.matrix'))`</h1>
                        <h4 data-toc-skip class="author">Sigbert
Klinke</h4>
                  <a class="author_email" href="mailto:#"></a><a href="mailto:sigbert@hu-berlin.de" class="email">sigbert@hu-berlin.de</a>
      
                  
            <h4 data-toc-skip class="date">09 十二月, 2022</h4>
      
      <small class="dont-index">Source: <a href="https://github.com/sigbertklinke/plot.matrix/blob/HEAD/vignettes/plot.matrix.Rmd" class="external-link"><code>vignettes/plot.matrix.Rmd</code></a></small>
      <div class="d-none name"><code>plot.matrix.Rmd</code></div>
    </div>

    
    
<div class="section level2">
<h2 id="general">General<a class="anchor" aria-label="anchor" href="#general"></a>
</h2>
<p>The aim of the package <code>plot.matrix</code> is to visualize a
matrix as is with a heatmap. Automatic reordering of rows and columns is
only done if necessary. This is different as in similar function like
<code>heatmap</code>. Additionally it should be user-friendly and give
access to a lot of options if necessary.</p>
<p>Currently the package implements the S3 functions below such that you
can use the generic <code>plot</code> function to plot matrices as
heatmaps:</p>
<ul>
<li>
<code>plot.matrix</code> for a heatmap for a plain matrix,</li>
<li>
<code>plot.loadings</code> for a heatmap for a loadings matrix from
factor analysis or principal component analysis (reordering of
rows!).</li>
</ul>
<p>The plot itself is composed by a heatmap (usually left) where colors
represent matrix entries and a key (usually right) which links the
colors to the values.</p>
<div class="section level3">
<h3 id="first-examples">First examples<a class="anchor" aria-label="anchor" href="#first-examples"></a>
</h3>
<div class="sourceCode" id="cb1"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="kw"><a href="https://rdrr.io/r/base/library.html" class="external-link">library</a></span><span class="op">(</span><span class="st"><a href="https://github.com/sigbertklinke/plot.matrix" class="external-link">'plot.matrix'</a></span><span class="op">)</span></span>
<span><span class="co"># numeric matrix</span></span>
<span><span class="va">x</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/matrix.html" class="external-link">matrix</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/stats/Uniform.html" class="external-link">runif</a></span><span class="op">(</span><span class="fl">35</span><span class="op">)</span>, ncol<span class="op">=</span><span class="fl">5</span><span class="op">)</span> <span class="co"># create a numeric matrix object</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/base/class.html" class="external-link">class</a></span><span class="op">(</span><span class="va">x</span><span class="op">)</span></span>
<span><span class="co">#&gt; [1] "matrix" "array"</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/graphics/par.html" class="external-link">par</a></span><span class="op">(</span>mar<span class="op">=</span><span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fl">5.1</span>, <span class="fl">4.1</span>, <span class="fl">4.1</span>, <span class="fl">4.1</span><span class="op">)</span><span class="op">)</span> <span class="co"># adapt margins</span></span>
<span><span class="fu"><a href="../reference/plot.matrix.html">plot</a></span><span class="op">(</span><span class="va">x</span><span class="op">)</span></span></code></pre></div>
<p><img src="plot.matrix_files/figure-html/unnamed-chunk-1-1.png" width="384"></p>
<div class="sourceCode" id="cb2"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="co"># logical matrix</span></span>
<span><span class="va">m</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/matrix.html" class="external-link">matrix</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/stats/Uniform.html" class="external-link">runif</a></span><span class="op">(</span><span class="fl">35</span><span class="op">)</span><span class="op">&lt;</span><span class="fl">0.5</span>, ncol<span class="op">=</span><span class="fl">7</span><span class="op">)</span></span>
<span><span class="fu"><a href="../reference/plot.matrix.html">plot</a></span><span class="op">(</span><span class="va">m</span><span class="op">)</span></span></code></pre></div>
<p><img src="plot.matrix_files/figure-html/unnamed-chunk-1-2.png" width="384"></p>
<div class="sourceCode" id="cb3"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="co"># text matrix</span></span>
<span><span class="va">s</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/matrix.html" class="external-link">matrix</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/sample.html" class="external-link">sample</a></span><span class="op">(</span><span class="va">letters</span><span class="op">[</span><span class="fl">1</span><span class="op">:</span><span class="fl">10</span><span class="op">]</span>, <span class="fl">35</span>, replace<span class="op">=</span><span class="cn">TRUE</span><span class="op">)</span>, ncol<span class="op">=</span><span class="fl">5</span><span class="op">)</span></span>
<span><span class="fu"><a href="../reference/plot.matrix.html">plot</a></span><span class="op">(</span><span class="va">s</span><span class="op">)</span></span></code></pre></div>
<p><img src="plot.matrix_files/figure-html/unnamed-chunk-1-3.png" width="384"></p>
<div class="sourceCode" id="cb4"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="kw"><a href="https://rdrr.io/r/base/library.html" class="external-link">library</a></span><span class="op">(</span><span class="st"><a href="https://github.com/sigbertklinke/plot.matrix" class="external-link">'plot.matrix'</a></span><span class="op">)</span></span>
<span><span class="kw"><a href="https://rdrr.io/r/base/library.html" class="external-link">library</a></span><span class="op">(</span><span class="st"><a href="https://personality-project.org/r/psych/" class="external-link">'psych'</a></span><span class="op">)</span></span>
<span><span class="va">data</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/stats/na.fail.html" class="external-link">na.omit</a></span><span class="op">(</span><span class="va">bfi</span><span class="op">[</span>,<span class="fl">1</span><span class="op">:</span><span class="fl">25</span><span class="op">]</span><span class="op">)</span></span>
<span><span class="va">fa</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/pkg/psych/man/fa.html" class="external-link">fa</a></span><span class="op">(</span><span class="va">data</span>, <span class="fl">5</span>, rotate<span class="op">=</span><span class="st">"varimax"</span><span class="op">)</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/graphics/par.html" class="external-link">par</a></span><span class="op">(</span>mar<span class="op">=</span><span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fl">5.1</span>, <span class="fl">4.1</span>, <span class="fl">4.1</span>, <span class="fl">4.1</span><span class="op">)</span><span class="op">)</span> <span class="co"># adapt margins</span></span>
<span><span class="fu"><a href="../reference/plot.matrix.html">plot</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/stats/loadings.html" class="external-link">loadings</a></span><span class="op">(</span><span class="va">fa</span><span class="op">)</span>, cex<span class="op">=</span><span class="fl">0.5</span><span class="op">)</span></span></code></pre></div>
<p><img src="plot.matrix_files/figure-html/unnamed-chunk-2-1.png" width="480"></p>
</div>
<div class="section level3">
<h3 id="assigning-colors-and-breaks">Assigning colors and breaks<a class="anchor" aria-label="anchor" href="#assigning-colors-and-breaks"></a>
</h3>
<p><code>plot.matrix</code> uses the command <code>assignColors</code>,
also part of <code>plot.matrix</code>, assigns to each value in
<code>x</code> a color based on the parameters <code>breaks</code>,
<code>col</code> and <code>na.col</code> given.</p>
<p>In case of a numeric matrix <code>breaks</code> can be</p>
<ul>
<li>a number, giving the number of intervals covering the range of
<code>x</code>,</li>
<li>a vector of two numbers, given the range to cover with 10 intervals,
or</li>
<li>a vector with more than two numbers, specify the interval
borders</li>
</ul>
<p>In case of a non-numeric vector <code>breaks</code> must contain all
values which are will get a color. If <code>breaks</code> is not given
then a sensible default is chosen: in case of a numeric vector derived
from <code>pretty</code> and otherwise all unique values/levels are
used.</p>
<p><code>col</code> can be either be a vector of colors or a function
which generates via <code>col(n)</code> a set of <code>n</code> colors.
The default is to use <code>heat.colors</code>.</p>
</div>
<div class="section level3">
<h3 id="choosing-color-palettesfunctions">Choosing color palettes/functions<a class="anchor" aria-label="anchor" href="#choosing-color-palettesfunctions"></a>
</h3>
<p>In case that you want to provide your own color palettes/functions
for plotting there are several good choices within R packages:</p>
<center>
<p><img src="029-r-color-palettes-r-color-scales-1.png" width="80%"></p>
<p>Source: <a href="https://www.datanovia.com/en/blog/top-r-color-palettes-to-know-for-great-data-visualization/" class="external-link">Datanovia
- Top R Color Palettes to Know for Great Data Visualization</a></p>
</center>
<ul>
<li><p><a href="https://CRAN.R-project.org/package=viridis" class="external-link"><code>viridis</code></a>
or <a href="https://CRAN.R-project.org/package=viridisLite" class="external-link"><code>viridisLite</code></a>,</p></li>
<li><p><a href="https://CRAN.R-project.org/package=RColorBrewer" class="external-link"><code>RColorBrewer</code></a>,</p></li>
<li><p><a href="https://CRAN.R-project.org/package=ggplot2" class="external-link"><code>ggplot2</code></a>,</p></li>
<li><p><a href="https://CRAN.R-project.org/package=ggsci" class="external-link"><code>ggsci</code></a>,</p></li>
<li><p><a href="https://CRAN.R-project.org/package=wesanderson" class="external-link"><code>wesanderson</code></a>,</p></li>
<li><p><a href="https://CRAN.R-project.org/package=cetcolor" class="external-link"><code>cetcolor</code></a>,</p></li>
<li><p><a href="https://CRAN.R-project.org/package=colormap" class="external-link"><code>colormap</code></a>,</p></li>
<li><p><a href="https://CRAN.R-project.org/package=ColorPalette" class="external-link"><code>ColorPalette</code></a>,</p></li>
<li><p><a href="https://CRAN.R-project.org/package=colorr" class="external-link"><code>colorr</code></a>,</p></li>
<li><p><a href="https://CRAN.R-project.org/package=colorRamps" class="external-link"><code>colorRamps</code></a>,</p></li>
<li><p><a href="https://CRAN.R-project.org/package=dichromat" class="external-link"><code>dichromat</code></a>,</p></li>
<li><p><a href="https://CRAN.R-project.org/package=jcolors" class="external-link"><code>jcolors</code></a>,</p></li>
<li><p><a href="https://CRAN.R-project.org/package=morgenstemning" class="external-link"><code>morgenstemning</code></a>,</p></li>
<li><p><a href="https://CRAN.R-project.org/package=painter" class="external-link"><code>painter</code></a>,</p></li>
<li><p><a href="https://CRAN.R-project.org/package=paletteer" class="external-link"><code>paletteer</code></a>,</p></li>
<li><p><a href="https://CRAN.R-project.org/package=pals" class="external-link"><code>pals</code></a>,</p></li>
<li><p><a href="https://CRAN.R-project.org/package=Polychrome" class="external-link"><code>Polychrome</code></a>,</p></li>
<li><p><a href="https://CRAN.R-project.org/package=qualpalr" class="external-link"><code>qualpalr</code></a>,</p></li>
<li><p><a href="https://CRAN.R-project.org/package=randomcoloR" class="external-link"><code>randomcoloR</code></a>,
or</p></li>
<li><p><a href="https://CRAN.R-project.org/package=Redmonder" class="external-link"><code>Redmonder</code></a>.</p></li>
</ul>
</div>
<div class="section level3">
<h3 id="structure-of-the-plot">Structure of the plot<a class="anchor" aria-label="anchor" href="#structure-of-the-plot"></a>
</h3>
<p>The plot is created in several steps</p>
<ol style="list-style-type: decimal">
<li>a call to the <code>plot</code> command to create the basic
plot</li>
<li>draw colored polygons for each matrix entry with the
<code>polygon</code> command</li>
<li>if necessary add the value of each matrix entry with the
<code>text</code> command in a polygon</li>
<li>if necessary draw x- and y-axis with the <code>axis</code> command
into the plot</li>
<li>if necessary draw the key with the <code>axis</code> and the
<code>polygon</code> command</li>
</ol>
</div>
<div class="section level3">
<h3 id="formal-parameters">Formal parameters<a class="anchor" aria-label="anchor" href="#formal-parameters"></a>
</h3>
<table class="table"><tbody>
<tr class="odd">
<td align="left">plot.matrix(</td>
<td align="left">x,</td>
<td align="left"></td>
<td align="left"></td>
</tr>
<tr class="even">
<td align="left"></td>
<td align="left">y</td>
<td align="left">=</td>
<td align="left">NULL,</td>
</tr>
<tr class="odd">
<td align="left"></td>
<td align="left">breaks</td>
<td align="left">=</td>
<td align="left">NULL,</td>
</tr>
<tr class="even">
<td align="left"></td>
<td align="left">col</td>
<td align="left">=</td>
<td align="left">heat.colors,</td>
</tr>
<tr class="odd">
<td align="left"></td>
<td align="left">na.col</td>
<td align="left">=</td>
<td align="left">“white”,</td>
</tr>
<tr class="even">
<td align="left"></td>
<td align="left">na.cell</td>
<td align="left">=</td>
<td align="left">TRUE,</td>
</tr>
<tr class="odd">
<td align="left"></td>
<td align="left">na.print</td>
<td align="left">=</td>
<td align="left">TRUE,</td>
</tr>
<tr class="even">
<td align="left"></td>
<td align="left">digits</td>
<td align="left">=</td>
<td align="left">NA,</td>
</tr>
<tr class="odd">
<td align="left"></td>
<td align="left">fmt.cell</td>
<td align="left">=</td>
<td align="left">NULL,</td>
</tr>
<tr class="even">
<td align="left"></td>
<td align="left">fmt.key</td>
<td align="left">=</td>
<td align="left">NULL,</td>
</tr>
<tr class="odd">
<td align="left"></td>
<td align="left">spacing.key</td>
<td align="left">=</td>
<td align="left">c(1, 0.5, 0),</td>
</tr>
<tr class="even">
<td align="left"></td>
<td align="left">polygon.cell</td>
<td align="left">=</td>
<td align="left">NULL,</td>
</tr>
<tr class="odd">
<td align="left"></td>
<td align="left">polygon.key</td>
<td align="left">=</td>
<td align="left">NULL,</td>
</tr>
<tr class="even">
<td align="left"></td>
<td align="left">text.cell</td>
<td align="left">=</td>
<td align="left">NULL,</td>
</tr>
<tr class="odd">
<td align="left"></td>
<td align="left">key</td>
<td align="left">=</td>
<td align="left">list(side = 4, las = 1),</td>
</tr>
<tr class="even">
<td align="left"></td>
<td align="left">axis.col</td>
<td align="left">=</td>
<td align="left">list(side = 1),</td>
</tr>
<tr class="odd">
<td align="left"></td>
<td align="left">axis.row</td>
<td align="left">=</td>
<td align="left">list(side = 2),</td>
</tr>
<tr class="even">
<td align="left"></td>
<td align="left">axis.key</td>
<td align="left">=</td>
<td align="left">NULL,</td>
</tr>
<tr class="odd">
<td align="left"></td>
<td align="left">max.col</td>
<td align="left">=</td>
<td align="left">70,</td>
</tr>
<tr class="even">
<td align="left"></td>
<td align="left">…)</td>
<td align="left"></td>
<td align="left"></td>
</tr>
</tbody></table>
<p>You may influence the appearance by setting your own parameters:</p>
<ol style="list-style-type: decimal">
<li>
<code>...</code> all parameters given here will be given to the
<code>plot</code> command, e.g. <code>xlab</code>, <code>ylab</code>,
….</li>
<li>
<code>polygon.cell</code> list of parameters for drawing polygons
for matrix entries</li>
<li>
<code>text.cell</code> list of parameters for putting for matrix
entries as texts</li>
<li>
<code>axis.col</code> and <code>axis.row</code> list of parameters
for drawing for row and column axes</li>
<li>
<code>key</code>, <code>axis.key</code>, <code>spacing.key</code>
and <code>polygon.key</code> to draw the key</li>
<li>
<code>max.col</code> to determine when text color and background
color to near</li>
</ol>
</div>
<div class="section level3">
<h3 id="set-global-parameters">Set global parameters<a class="anchor" aria-label="anchor" href="#set-global-parameters"></a>
</h3>
<p>You may set global parameters for all subsequent calls of
<code>axis</code>, <code>polygon</code> and <code>text</code> via the
<code>...</code>. The following parameters are supported</p>
<table class="table">
<colgroup>
<col width="12%">
<col width="87%">
</colgroup>
<thead><tr class="header">
<th>function</th>
<th>parameter(s)</th>
</tr></thead>
<tbody>
<tr class="odd">
<td><code>axis</code></td>
<td>
<code>cex.axis</code>, <code>col.axis</code>,
<code>col.ticks</code>, <code>font</code>, <code>font.axis</code>,
<code>hadj</code>, <code>las</code>, <code>lwd.ticks</code>,
<code>line</code> , <code>outer</code>, <code>padj</code>,
<code>tck</code>, <code>tcl</code>, <code>tick</code>
</td>
</tr>
<tr class="even">
<td><code>polygon</code></td>
<td>
<code>angle</code>, <code>border</code>, <code>density</code>
</td>
</tr>
<tr class="odd">
<td><code>text</code></td>
<td>
<code>cex</code>, <code>font</code>, <code>vfont</code>
</td>
</tr>
</tbody>
</table>
<div class="sourceCode" id="cb5"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu"><a href="https://rdrr.io/r/graphics/par.html" class="external-link">par</a></span><span class="op">(</span>mar<span class="op">=</span><span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fl">5.1</span>, <span class="fl">4.1</span>, <span class="fl">4.1</span>, <span class="fl">4.1</span><span class="op">)</span><span class="op">)</span> <span class="co"># adapt margins</span></span>
<span><span class="co"># omit all borders</span></span>
<span><span class="fu"><a href="../reference/plot.matrix.html">plot</a></span><span class="op">(</span><span class="va">x</span>, border<span class="op">=</span><span class="cn">NA</span><span class="op">)</span></span></code></pre></div>
<p><img src="plot.matrix_files/figure-html/unnamed-chunk-4-1.png" width="384"></p>
</div>
</div>
<div class="section level2">
<h2 id="frequently-asked-questions">Frequently asked questions<a class="anchor" aria-label="anchor" href="#frequently-asked-questions"></a>
</h2>
<div class="section level3">
<h3 id="how-can-i-delete-the-grid-lines">How can I delete the grid lines?<a class="anchor" aria-label="anchor" href="#how-can-i-delete-the-grid-lines"></a>
</h3>
<p>Use the parameter <code>border=NA</code>.</p>
</div>
<div class="section level3">
<h3 id="how-can-i-get-squared-boxes">How can I get squared boxes?<a class="anchor" aria-label="anchor" href="#how-can-i-get-squared-boxes"></a>
</h3>
<p>Use the parameter <code>asp=TRUE</code>.</p>
</div>
<div class="section level3">
<h3 id="how-can-i-rotate-the-axis-labels-such-they-do-no-overlap">How can I rotate the axis labels such they do no overlap?<a class="anchor" aria-label="anchor" href="#how-can-i-rotate-the-axis-labels-such-they-do-no-overlap"></a>
</h3>
<p>Use the parameter <code>las</code>, the style of axis labels, in
<code>axis.col</code>and/or <code>axis.row</code> with</p>
<ul>
<li>
<code>0</code> = always parallel to the axis [default],</li>
<li>
<code>1</code> = always horizontal,</li>
<li>
<code>2</code> = always perpendicular to the axis, and</li>
<li>
<code>3</code> = always vertical.</li>
</ul>
<div class="sourceCode" id="cb6"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">x</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/matrix.html" class="external-link">matrix</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/stats/Uniform.html" class="external-link">runif</a></span><span class="op">(</span><span class="fl">35</span><span class="op">)</span>, ncol<span class="op">=</span><span class="fl">5</span><span class="op">)</span> <span class="co"># create a numeric matrix object</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/graphics/par.html" class="external-link">par</a></span><span class="op">(</span>mar<span class="op">=</span><span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fl">5.1</span>, <span class="fl">4.1</span>, <span class="fl">4.1</span>, <span class="fl">4.1</span><span class="op">)</span><span class="op">)</span> <span class="co"># adapt margins such that all labels are visible</span></span>
<span><span class="fu"><a href="../reference/plot.matrix.html">plot</a></span><span class="op">(</span><span class="va">x</span>, axis.col<span class="op">=</span><span class="fu"><a href="https://rdrr.io/r/base/list.html" class="external-link">list</a></span><span class="op">(</span>side<span class="op">=</span><span class="fl">1</span>, las<span class="op">=</span><span class="fl">2</span><span class="op">)</span>, axis.row <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/list.html" class="external-link">list</a></span><span class="op">(</span>side<span class="op">=</span><span class="fl">2</span>, las<span class="op">=</span><span class="fl">1</span><span class="op">)</span><span class="op">)</span></span></code></pre></div>
<p><img src="plot.matrix_files/figure-html/unnamed-chunk-5-1.png" width="384"></p>
</div>
<div class="section level3">
<h3 id="how-can-i-show-a-matrix-of-parameters-and-for-example-their-standard-errors-below">How can I show a matrix of parameters and, for example, their
standard errors below?<a class="anchor" aria-label="anchor" href="#how-can-i-show-a-matrix-of-parameters-and-for-example-their-standard-errors-below"></a>
</h3>
<p>You need to access the position of the cell text used by accessing
the invisible return of <code>plot.matrix</code>. The
<code>cell.text</code> contains the parameters used to draw the
text.</p>
<p><strong>Note</strong> the double braces: <code>[[i,j]]</code></p>
<div class="sourceCode" id="cb7"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">param_est</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/matrix.html" class="external-link">matrix</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/stats/Uniform.html" class="external-link">runif</a></span><span class="op">(</span><span class="fl">25</span><span class="op">)</span>, nrow<span class="op">=</span><span class="fl">5</span><span class="op">)</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/graphics/par.html" class="external-link">par</a></span><span class="op">(</span>mar<span class="op">=</span><span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fl">5.1</span>, <span class="fl">4.1</span>, <span class="fl">4.1</span>, <span class="fl">4.1</span><span class="op">)</span><span class="op">)</span> <span class="co"># adapt margins such that all labels are visible</span></span>
<span><span class="va">res</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/plot.matrix.html">plot</a></span><span class="op">(</span><span class="va">param_est</span>, digits<span class="op">=</span><span class="fl">2</span>, text.cell<span class="op">=</span><span class="fu"><a href="https://rdrr.io/r/base/list.html" class="external-link">list</a></span><span class="op">(</span>pos<span class="op">=</span><span class="fl">3</span>, cex<span class="op">=</span><span class="fl">0.75</span><span class="op">)</span><span class="op">)</span></span>
<span><span class="va">sderr_est</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/matrix.html" class="external-link">matrix</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/stats/Uniform.html" class="external-link">runif</a></span><span class="op">(</span><span class="fl">25</span><span class="op">)</span><span class="op">/</span><span class="fl">10</span>, nrow<span class="op">=</span><span class="fl">5</span><span class="op">)</span></span>
<span><span class="kw">for</span> <span class="op">(</span><span class="va">i</span> <span class="kw">in</span> <span class="fl">1</span><span class="op">:</span><span class="fu"><a href="https://rdrr.io/r/base/nrow.html" class="external-link">nrow</a></span><span class="op">(</span><span class="va">param_est</span><span class="op">)</span><span class="op">)</span> <span class="op">{</span></span>
<span>  <span class="kw">for</span> <span class="op">(</span><span class="va">j</span> <span class="kw">in</span> <span class="fl">1</span><span class="op">:</span><span class="fu"><a href="https://rdrr.io/r/base/nrow.html" class="external-link">ncol</a></span><span class="op">(</span><span class="va">param_est</span><span class="op">)</span><span class="op">)</span> <span class="op">{</span>  </span>
<span>    <span class="va">args</span> <span class="op">&lt;-</span> <span class="va">res</span><span class="op">$</span><span class="va">cell.text</span><span class="op">[[</span><span class="va">i</span>,<span class="va">j</span><span class="op">]</span><span class="op">]</span></span>
<span>    <span class="va">args</span><span class="op">$</span><span class="va">labels</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/paste.html" class="external-link">paste0</a></span><span class="op">(</span><span class="st">'('</span>, <span class="fu"><a href="../reference/fmt.html">fmt</a></span><span class="op">(</span><span class="va">sderr_est</span><span class="op">[</span><span class="va">i</span>,<span class="va">j</span><span class="op">]</span>, <span class="fl">3</span><span class="op">)</span>, <span class="st">')'</span><span class="op">)</span></span>
<span>    <span class="va">args</span><span class="op">$</span><span class="va">cex</span>    <span class="op">&lt;-</span> <span class="fl">0.5</span></span>
<span>    <span class="va">args</span><span class="op">$</span><span class="va">pos</span>    <span class="op">&lt;-</span> <span class="fl">1</span></span>
<span>    <span class="fu"><a href="https://rdrr.io/r/base/do.call.html" class="external-link">do.call</a></span><span class="op">(</span><span class="va">text</span>, <span class="va">args</span><span class="op">)</span></span>
<span>  <span class="op">}</span></span>
<span><span class="op">}</span></span></code></pre></div>
<p><img src="plot.matrix_files/figure-html/unnamed-chunk-6-1.png" width="384"></p>
<p>Or alternatively</p>
<div class="sourceCode" id="cb8"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">param_est</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/matrix.html" class="external-link">matrix</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/stats/Uniform.html" class="external-link">runif</a></span><span class="op">(</span><span class="fl">25</span><span class="op">)</span>, nrow<span class="op">=</span><span class="fl">5</span><span class="op">)</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/graphics/par.html" class="external-link">par</a></span><span class="op">(</span>mar<span class="op">=</span><span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fl">5.1</span>, <span class="fl">4.1</span>, <span class="fl">4.1</span>, <span class="fl">4.1</span><span class="op">)</span><span class="op">)</span> <span class="co"># adapt margins such that all labels are visible</span></span>
<span><span class="va">res</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/plot.matrix.html">plot</a></span><span class="op">(</span><span class="va">param_est</span>, digits<span class="op">=</span><span class="fl">2</span>, text.cell<span class="op">=</span><span class="fu"><a href="https://rdrr.io/r/base/list.html" class="external-link">list</a></span><span class="op">(</span>cex<span class="op">=</span><span class="fl">0.75</span><span class="op">)</span><span class="op">)</span></span>
<span><span class="va">sderr_est</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/matrix.html" class="external-link">matrix</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/stats/Uniform.html" class="external-link">runif</a></span><span class="op">(</span><span class="fl">25</span><span class="op">)</span><span class="op">/</span><span class="fl">10</span>, nrow<span class="op">=</span><span class="fl">5</span><span class="op">)</span></span>
<span><span class="kw">for</span> <span class="op">(</span><span class="va">i</span> <span class="kw">in</span> <span class="fl">1</span><span class="op">:</span><span class="fu"><a href="https://rdrr.io/r/base/nrow.html" class="external-link">nrow</a></span><span class="op">(</span><span class="va">param_est</span><span class="op">)</span><span class="op">)</span> <span class="op">{</span></span>
<span>  <span class="kw">for</span> <span class="op">(</span><span class="va">j</span> <span class="kw">in</span> <span class="fl">1</span><span class="op">:</span><span class="fu"><a href="https://rdrr.io/r/base/nrow.html" class="external-link">ncol</a></span><span class="op">(</span><span class="va">param_est</span><span class="op">)</span><span class="op">)</span> <span class="op">{</span>  </span>
<span>    <span class="va">args</span> <span class="op">&lt;-</span> <span class="va">res</span><span class="op">$</span><span class="va">cell.text</span><span class="op">[[</span><span class="va">i</span>,<span class="va">j</span><span class="op">]</span><span class="op">]</span></span>
<span>    <span class="va">args</span><span class="op">$</span><span class="va">labels</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/paste.html" class="external-link">paste0</a></span><span class="op">(</span><span class="st">'('</span>, <span class="fu"><a href="https://rdrr.io/r/base/Round.html" class="external-link">round</a></span><span class="op">(</span><span class="va">sderr_est</span><span class="op">[</span><span class="va">i</span>,<span class="va">j</span><span class="op">]</span>, <span class="fl">3</span><span class="op">)</span>, <span class="st">')'</span><span class="op">)</span></span>
<span>    <span class="va">args</span><span class="op">$</span><span class="va">cex</span>    <span class="op">&lt;-</span> <span class="fl">0.6</span></span>
<span>    <span class="va">args</span><span class="op">$</span><span class="va">y</span>      <span class="op">&lt;-</span> <span class="va">args</span><span class="op">$</span><span class="va">y</span><span class="op">-</span><span class="fl">0.3</span></span>
<span>    <span class="fu"><a href="https://rdrr.io/r/base/do.call.html" class="external-link">do.call</a></span><span class="op">(</span><span class="va">text</span>, <span class="va">args</span><span class="op">)</span></span>
<span>  <span class="op">}</span></span>
<span><span class="op">}</span></span></code></pre></div>
<p><img src="plot.matrix_files/figure-html/unnamed-chunk-7-1.png" width="384"></p>
</div>
<div class="section level3">
<h3 id="how-can-i-use-plot-matrix-and-the-default-scatter-plot-in-parallel">How can I use <code>plot.matrix</code> and the default scatter plot
in parallel?<a class="anchor" aria-label="anchor" href="#how-can-i-use-plot-matrix-and-the-default-scatter-plot-in-parallel"></a>
</h3>
<p>The example illustrates the problem: the loadings of the factor
analysis should be plotted as matrix and the factor scores as a scatter
plot.</p>
<div class="sourceCode" id="cb9"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu"><a href="https://rdrr.io/r/graphics/par.html" class="external-link">par</a></span><span class="op">(</span>mar<span class="op">=</span><span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fl">5.1</span>, <span class="fl">4.1</span>, <span class="fl">4.1</span>, <span class="fl">4.1</span><span class="op">)</span><span class="op">)</span> <span class="co"># adapt margins such that all labels are visible</span></span>
<span><span class="kw"><a href="https://rdrr.io/r/base/library.html" class="external-link">library</a></span><span class="op">(</span><span class="st"><a href="https://github.com/sigbertklinke/plot.matrix" class="external-link">"plot.matrix"</a></span><span class="op">)</span></span>
<span><span class="kw"><a href="https://rdrr.io/r/base/library.html" class="external-link">library</a></span><span class="op">(</span><span class="st"><a href="https://personality-project.org/r/psych/" class="external-link">"psych"</a></span><span class="op">)</span></span>
<span><span class="va">fa</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/pkg/psych/man/fa.html" class="external-link">fa</a></span><span class="op">(</span><span class="va">iris</span><span class="op">[</span>,<span class="op">-</span><span class="fl">5</span><span class="op">]</span>, <span class="fl">2</span><span class="op">)</span></span>
<span><span class="co">#&gt; Loading required namespace: GPArotation</span></span>
<span><span class="fu"><a href="../reference/plot.matrix.html">plot</a></span><span class="op">(</span><span class="va">fa</span><span class="op">$</span><span class="va">loadings</span><span class="op">)</span> </span></code></pre></div>
<p><img src="plot.matrix_files/figure-html/unnamed-chunk-8-1.png" width="700"></p>
<div class="sourceCode" id="cb10"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu"><a href="../reference/plot.matrix.html">plot</a></span><span class="op">(</span><span class="va">fa</span><span class="op">$</span><span class="va">scores</span><span class="op">)</span></span></code></pre></div>
<p><img src="plot.matrix_files/figure-html/unnamed-chunk-8-2.png" width="700"></p>
<div class="section level4">
<h4 id="solution-1-convert-the-matrix-to-a-data-frame">Solution 1: Convert the matrix to a <code>data.frame</code><a class="anchor" aria-label="anchor" href="#solution-1-convert-the-matrix-to-a-data-frame"></a>
</h4>
<div class="sourceCode" id="cb11"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu"><a href="https://rdrr.io/r/graphics/par.html" class="external-link">par</a></span><span class="op">(</span>mar<span class="op">=</span><span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fl">5.1</span>, <span class="fl">4.1</span>, <span class="fl">4.1</span>, <span class="fl">4.1</span><span class="op">)</span><span class="op">)</span> <span class="co"># adapt margins such that all labels are visible</span></span>
<span><span class="va">fa</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/pkg/psych/man/fa.html" class="external-link">fa</a></span><span class="op">(</span><span class="va">iris</span><span class="op">[</span>,<span class="op">-</span><span class="fl">5</span><span class="op">]</span>, nfactor<span class="op">=</span><span class="fl">2</span><span class="op">)</span></span>
<span><span class="co">#&gt; Loading required namespace: GPArotation</span></span>
<span><span class="fu"><a href="../reference/plot.matrix.html">plot</a></span><span class="op">(</span><span class="va">fa</span><span class="op">$</span><span class="va">loadings</span><span class="op">)</span> </span></code></pre></div>
<p><img src="plot.matrix_files/figure-html/unnamed-chunk-9-1.png" width="700"></p>
<div class="sourceCode" id="cb12"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu"><a href="../reference/plot.matrix.html">plot</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/as.data.frame.html" class="external-link">as.data.frame</a></span><span class="op">(</span><span class="va">fa</span><span class="op">$</span><span class="va">scores</span><span class="op">)</span><span class="op">)</span></span></code></pre></div>
<p><img src="plot.matrix_files/figure-html/unnamed-chunk-9-2.png" width="700"></p>
</div>
<div class="section level4">
<h4 id="solution-2-use-plot-default">Solution 2: Use <code>plot.default</code><a class="anchor" aria-label="anchor" href="#solution-2-use-plot-default"></a>
</h4>
<div class="sourceCode" id="cb13"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu"><a href="https://rdrr.io/r/graphics/par.html" class="external-link">par</a></span><span class="op">(</span>mar<span class="op">=</span><span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fl">5.1</span>, <span class="fl">4.1</span>, <span class="fl">4.1</span>, <span class="fl">4.1</span><span class="op">)</span><span class="op">)</span> <span class="co"># adapt margins such that all labels are visible</span></span>
<span><span class="va">fa</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/pkg/psych/man/fa.html" class="external-link">fa</a></span><span class="op">(</span><span class="va">iris</span><span class="op">[</span>,<span class="op">-</span><span class="fl">5</span><span class="op">]</span>, nfactors<span class="op">=</span><span class="fl">2</span><span class="op">)</span></span>
<span><span class="co">#&gt; Loading required namespace: GPArotation</span></span>
<span><span class="fu"><a href="../reference/plot.matrix.html">plot</a></span><span class="op">(</span><span class="va">fa</span><span class="op">$</span><span class="va">loadings</span><span class="op">)</span> </span></code></pre></div>
<p><img src="plot.matrix_files/figure-html/unnamed-chunk-10-1.png" width="700"></p>
<div class="sourceCode" id="cb14"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu"><a href="https://rdrr.io/r/graphics/plot.default.html" class="external-link">plot.default</a></span><span class="op">(</span><span class="va">fa</span><span class="op">$</span><span class="va">scores</span><span class="op">)</span></span></code></pre></div>
<p><img src="plot.matrix_files/figure-html/unnamed-chunk-10-2.png" width="700"></p>
</div>
<div class="section level4">
<h4 id="solution-3-unload-the-package-plot-matrix-permanently">Solution 3: Unload the package <code>plot.matrix</code>
permanently<a class="anchor" aria-label="anchor" href="#solution-3-unload-the-package-plot-matrix-permanently"></a>
</h4>
<p>If do not want to use the package <code>plot.matrix</code> for
further plotting then unload the package including the installed S3
functions with <code><a href="https://pkgload.r-lib.org/reference/unload.html" class="external-link">devtools::unload</a></code></p>
<div class="sourceCode" id="cb15"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu"><a href="https://rdrr.io/r/graphics/par.html" class="external-link">par</a></span><span class="op">(</span>mar<span class="op">=</span><span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fl">5.1</span>, <span class="fl">4.1</span>, <span class="fl">4.1</span>, <span class="fl">4.1</span><span class="op">)</span><span class="op">)</span> <span class="co"># adapt margins such that all labels are visible</span></span>
<span><span class="kw"><a href="https://rdrr.io/r/base/library.html" class="external-link">library</a></span><span class="op">(</span><span class="st"><a href="https://github.com/sigbertklinke/plot.matrix" class="external-link">"plot.matrix"</a></span><span class="op">)</span></span>
<span><span class="kw"><a href="https://rdrr.io/r/base/library.html" class="external-link">library</a></span><span class="op">(</span><span class="st"><a href="https://personality-project.org/r/psych/" class="external-link">"psych"</a></span><span class="op">)</span></span>
<span><span class="va">fa</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/pkg/psych/man/fa.html" class="external-link">fa</a></span><span class="op">(</span><span class="va">iris</span><span class="op">[</span>,<span class="op">-</span><span class="fl">5</span><span class="op">]</span>, <span class="fl">2</span><span class="op">)</span></span>
<span><span class="co">#&gt; Loading required namespace: GPArotation</span></span>
<span><span class="fu"><a href="../reference/plot.matrix.html">plot</a></span><span class="op">(</span><span class="va">fa</span><span class="op">$</span><span class="va">loadings</span><span class="op">)</span> </span></code></pre></div>
<p><img src="plot.matrix_files/figure-html/unnamed-chunk-11-1.png" width="700"></p>
<div class="sourceCode" id="cb16"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu">devtools</span><span class="fu">::</span><span class="fu"><a href="https://pkgload.r-lib.org/reference/unload.html" class="external-link">unload</a></span><span class="op">(</span><span class="st">'plot.matrix'</span><span class="op">)</span> <span class="co"># Package devtools must be installed!</span></span>
<span><span class="fu"><a href="../reference/plot.matrix.html">plot</a></span><span class="op">(</span><span class="va">fa</span><span class="op">$</span><span class="va">scores</span><span class="op">)</span></span></code></pre></div>
<p><img src="plot.matrix_files/figure-html/unnamed-chunk-11-2.png" width="700"></p>
</div>
</div>
</div>
<div class="section level2">
<h2 id="modifying-a-plot">Modifying a plot<a class="anchor" aria-label="anchor" href="#modifying-a-plot"></a>
</h2>
<div class="section level3">
<h3 id="defaults">Defaults<a class="anchor" aria-label="anchor" href="#defaults"></a>
</h3>
<p>The default plot always draws a heatmap and a key where the colors
and breaks are determined by the entries of <code>x</code>. In case of a
numeric matrix ten colors from <code>heat.colors</code> are chosen and
eleven breaks with cover the range of entries with an equidistant grid.
In case of a non-numeric matrix each unique element gets a color
determined from <code>heat.colors</code>.</p>
</div>
<div class="section level3">
<h3 id="modifying-the-breaks">Modifying the breaks<a class="anchor" aria-label="anchor" href="#modifying-the-breaks"></a>
</h3>
<p>In case of a numeric matrix the <code>breaks</code> give the interval
borders for a color otherwise for each unique matrix entry
<code>breaks</code> should contain a value. If <code>breaks</code> are
not given then they will be determined from the matrix object by using
the <code>pretty</code> function of base R.</p>
<div class="sourceCode" id="cb17"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu"><a href="https://rdrr.io/r/graphics/par.html" class="external-link">par</a></span><span class="op">(</span>mar<span class="op">=</span><span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fl">5.1</span>, <span class="fl">4.1</span>, <span class="fl">4.1</span>, <span class="fl">4.1</span><span class="op">)</span><span class="op">)</span>   <span class="co"># adapt margins</span></span>
<span><span class="co"># we only want the range of x</span></span>
<span><span class="fu"><a href="../reference/plot.matrix.html">plot</a></span><span class="op">(</span><span class="va">x</span>, breaks<span class="op">=</span><span class="fu"><a href="https://rdrr.io/r/base/range.html" class="external-link">range</a></span><span class="op">(</span><span class="va">x</span><span class="op">)</span><span class="op">)</span>     </span></code></pre></div>
<p><img src="plot.matrix_files/figure-html/unnamed-chunk-13-1.png" width="384"></p>
<div class="sourceCode" id="cb18"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="co"># we want seven colors</span></span>
<span><span class="fu"><a href="../reference/plot.matrix.html">plot</a></span><span class="op">(</span><span class="va">x</span>, breaks<span class="op">=</span><span class="fl">7</span><span class="op">)</span>  </span></code></pre></div>
<p><img src="plot.matrix_files/figure-html/unnamed-chunk-13-2.png" width="384"></p>
<div class="sourceCode" id="cb19"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="co"># user defined breaks, out-of-range entries are colored white</span></span>
<span><span class="fu"><a href="../reference/plot.matrix.html">plot</a></span><span class="op">(</span><span class="va">x</span>, breaks<span class="op">=</span><span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fl">0.3</span>,<span class="fl">0.5</span>,<span class="fl">0.8</span><span class="op">)</span><span class="op">)</span>  </span></code></pre></div>
<p><img src="plot.matrix_files/figure-html/unnamed-chunk-13-3.png" width="384"></p>
</div>
<div class="section level3">
<h3 id="modifying-the-colors">Modifying the colors<a class="anchor" aria-label="anchor" href="#modifying-the-colors"></a>
</h3>
<div class="section level4">
<h4 id="cell-colors">Cell colors<a class="anchor" aria-label="anchor" href="#cell-colors"></a>
</h4>
<p>The <code>col</code> parameter is either a vector of colors used or a
function <code>mycolor(n)</code> which returns <code>n</code> colors on
request.</p>
<div class="sourceCode" id="cb20"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu"><a href="https://rdrr.io/r/graphics/par.html" class="external-link">par</a></span><span class="op">(</span>mar<span class="op">=</span><span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fl">5.1</span>, <span class="fl">4.1</span>, <span class="fl">4.1</span>, <span class="fl">4.1</span><span class="op">)</span><span class="op">)</span>   <span class="co"># adapt margins</span></span>
<span><span class="co"># use a color function</span></span>
<span><span class="fu"><a href="../reference/plot.matrix.html">plot</a></span><span class="op">(</span><span class="va">x</span>, col<span class="op">=</span><span class="va">topo.colors</span><span class="op">)</span></span></code></pre></div>
<p><img src="plot.matrix_files/figure-html/unnamed-chunk-14-1.png" width="384"></p>
<div class="sourceCode" id="cb21"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="co"># user defined breaks and colors</span></span>
<span><span class="fu"><a href="../reference/plot.matrix.html">plot</a></span><span class="op">(</span><span class="va">x</span>, col<span class="op">=</span><span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">'red'</span>, <span class="st">'green'</span><span class="op">)</span>, breaks<span class="op">=</span><span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fl">0</span>, <span class="fl">0.5</span>, <span class="fl">1</span><span class="op">)</span><span class="op">)</span>   </span></code></pre></div>
<p><img src="plot.matrix_files/figure-html/unnamed-chunk-14-2.png" width="384"></p>
<div class="sourceCode" id="cb22"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="co"># non-numeric matrix</span></span>
<span><span class="co"># assign colors</span></span>
<span><span class="fu"><a href="../reference/plot.matrix.html">plot</a></span><span class="op">(</span><span class="va">m</span>, col<span class="op">=</span><span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">'red'</span>, <span class="st">'green'</span><span class="op">)</span><span class="op">)</span></span></code></pre></div>
<p><img src="plot.matrix_files/figure-html/unnamed-chunk-14-3.png" width="384"></p>
<div class="sourceCode" id="cb23"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="co"># assign colors and breaks directly </span></span>
<span><span class="fu"><a href="../reference/plot.matrix.html">plot</a></span><span class="op">(</span><span class="va">m</span>, col<span class="op">=</span><span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">'red'</span>, <span class="st">'green'</span><span class="op">)</span>, breaks<span class="op">=</span><span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="cn">TRUE</span>, <span class="cn">FALSE</span><span class="op">)</span><span class="op">)</span></span></code></pre></div>
<p><img src="plot.matrix_files/figure-html/unnamed-chunk-14-4.png" width="384"></p>
<p>Note that for numeric matrices must hold
<code>length(breaks)==length(col)+1</code> and for non-numeric matrices
<code>length(breaks)==length(col)</code>.</p>
</div>
<div class="section level4">
<h4 id="missing-values-and-out-of-range-matrix-entries">Missing values and out-of-range matrix entries<a class="anchor" aria-label="anchor" href="#missing-values-and-out-of-range-matrix-entries"></a>
</h4>
<p>The parameter <code>na.col</code> determines the color for missing
values and for matrix entries outside the current color scheme.</p>
<div class="sourceCode" id="cb24"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu"><a href="https://rdrr.io/r/graphics/par.html" class="external-link">par</a></span><span class="op">(</span>mar<span class="op">=</span><span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fl">5.1</span>, <span class="fl">4.1</span>, <span class="fl">4.1</span>, <span class="fl">4.1</span><span class="op">)</span><span class="op">)</span>   <span class="co"># adapt margins</span></span>
<span><span class="va">x</span><span class="op">[</span><span class="fl">1</span>,<span class="fl">1</span><span class="op">]</span> <span class="op">&lt;-</span> <span class="cn">NA</span></span>
<span><span class="fu"><a href="../reference/plot.matrix.html">plot</a></span><span class="op">(</span><span class="va">x</span>, col<span class="op">=</span><span class="va">topo.colors</span><span class="op">)</span></span></code></pre></div>
<p><img src="plot.matrix_files/figure-html/unnamed-chunk-15-1.png" width="384"></p>
<div class="sourceCode" id="cb25"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu"><a href="../reference/plot.matrix.html">plot</a></span><span class="op">(</span><span class="va">x</span>, col<span class="op">=</span><span class="va">topo.colors</span>, na.col<span class="op">=</span><span class="st">"red"</span><span class="op">)</span></span></code></pre></div>
<p><img src="plot.matrix_files/figure-html/unnamed-chunk-15-2.png" width="384"></p>
<div class="sourceCode" id="cb26"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu"><a href="../reference/plot.matrix.html">plot</a></span><span class="op">(</span><span class="va">s</span>, col<span class="op">=</span><span class="va">topo.colors</span>, breaks<span class="op">=</span><span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">'a'</span>, <span class="st">'c'</span>, <span class="st">'e'</span>, <span class="st">'g'</span>, <span class="st">'i'</span><span class="op">)</span><span class="op">)</span></span></code></pre></div>
<p><img src="plot.matrix_files/figure-html/unnamed-chunk-15-3.png" width="384"></p>
</div>
</div>
<div class="section level3">
<h3 id="modifying-the-key">Modifying the key<a class="anchor" aria-label="anchor" href="#modifying-the-key"></a>
</h3>
<div class="section level4">
<h4 id="delete-the-key">Delete the key<a class="anchor" aria-label="anchor" href="#delete-the-key"></a>
</h4>
<p>For deleting the key set <code>key=NULL</code>:</p>
<div class="sourceCode" id="cb27"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu"><a href="https://rdrr.io/r/graphics/par.html" class="external-link">par</a></span><span class="op">(</span>mar<span class="op">=</span><span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fl">5.1</span>, <span class="fl">4.1</span>, <span class="fl">4.1</span>, <span class="fl">4.1</span><span class="op">)</span><span class="op">)</span>   <span class="co"># adapt margins</span></span>
<span><span class="co"># delete key</span></span>
<span><span class="fu"><a href="../reference/plot.matrix.html">plot</a></span><span class="op">(</span><span class="va">x</span>, key<span class="op">=</span><span class="cn">NULL</span><span class="op">)</span></span></code></pre></div>
<p><img src="plot.matrix_files/figure-html/unnamed-chunk-16-1.png" width="384"></p>
</div>
<div class="section level4">
<h4 id="move-the-key">Move the key<a class="anchor" aria-label="anchor" href="#move-the-key"></a>
</h4>
<p>For moving the key to a different axis use <code>key</code> or
<code>axis.key</code>. Note that only a warning is issued if the axes
for rows, columns or the key are at the same side.</p>
<div class="sourceCode" id="cb28"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu"><a href="https://rdrr.io/r/graphics/par.html" class="external-link">par</a></span><span class="op">(</span>mar<span class="op">=</span><span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fl">5.1</span>, <span class="fl">4.1</span>, <span class="fl">5.1</span>, <span class="fl">4.1</span><span class="op">)</span><span class="op">)</span>   <span class="co"># adapt margins</span></span>
<span><span class="co"># move key to the top and make axis text smaller</span></span>
<span><span class="fu"><a href="../reference/plot.matrix.html">plot</a></span><span class="op">(</span><span class="va">x</span>, key<span class="op">=</span><span class="fu"><a href="https://rdrr.io/r/base/list.html" class="external-link">list</a></span><span class="op">(</span>side<span class="op">=</span><span class="fl">3</span>, cex.axis<span class="op">=</span><span class="fl">0.75</span><span class="op">)</span>, breaks<span class="op">=</span><span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fl">0</span>,<span class="fl">1</span><span class="op">)</span><span class="op">)</span></span></code></pre></div>
<p><img src="plot.matrix_files/figure-html/unnamed-chunk-17-1.png" width="384"></p>
<p>The parameter <code>spacing.key</code> gives the spacing between plot
and the key, the width of the key and the spacing between the key and
the axis. If you give a vector of length 1 or 2 then the missing values
will be appended with the defaults <code>c(1, 0.5, 0)</code></p>
<div class="sourceCode" id="cb29"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu"><a href="https://rdrr.io/r/graphics/par.html" class="external-link">par</a></span><span class="op">(</span>mar<span class="op">=</span><span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fl">5.1</span>, <span class="fl">4.1</span>, <span class="fl">5.1</span>, <span class="fl">4.1</span><span class="op">)</span><span class="op">)</span>   <span class="co"># adapt margins</span></span>
<span><span class="co"># move key to the top, make axis text smaller, and move key farther away from the plot</span></span>
<span><span class="fu"><a href="../reference/plot.matrix.html">plot</a></span><span class="op">(</span><span class="va">x</span>, key<span class="op">=</span><span class="fu"><a href="https://rdrr.io/r/base/list.html" class="external-link">list</a></span><span class="op">(</span>side<span class="op">=</span><span class="fl">3</span>, cex.axis<span class="op">=</span><span class="fl">0.75</span><span class="op">)</span>, breaks<span class="op">=</span><span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fl">0</span>,<span class="fl">1</span><span class="op">)</span>, spacing.key<span class="op">=</span><span class="fl">2</span><span class="op">)</span></span></code></pre></div>
<p><img src="plot.matrix_files/figure-html/unnamed-chunk-18-1.png" width="384"></p>
<p>For a very large matrix</p>
<div class="sourceCode" id="cb30"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu"><a href="https://rdrr.io/r/graphics/par.html" class="external-link">par</a></span><span class="op">(</span>mar<span class="op">=</span><span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fl">5.1</span>, <span class="fl">4.1</span>, <span class="fl">5.1</span>, <span class="fl">4.1</span><span class="op">)</span><span class="op">)</span>   <span class="co"># adapt margins</span></span>
<span><span class="va">xl</span>  <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/array.html" class="external-link">array</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/stats/Uniform.html" class="external-link">runif</a></span><span class="op">(</span><span class="fl">1e4</span><span class="op">)</span>, <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fl">1e2</span>, <span class="fl">1e2</span><span class="op">)</span><span class="op">)</span></span>
<span><span class="va">brk</span> <span class="op">&lt;-</span> <span class="fl">20</span></span>
<span><span class="fu"><a href="../reference/plot.matrix.html">plot</a></span><span class="op">(</span><span class="va">xl</span>, border<span class="op">=</span><span class="cn">NA</span>, breaks<span class="op">=</span><span class="va">brk</span>, col<span class="op">=</span><span class="fu"><a href="https://rdrr.io/r/grDevices/palettes.html" class="external-link">heat.colors</a></span><span class="op">(</span><span class="va">brk</span><span class="op">)</span>, </span>
<span>     key<span class="op">=</span><span class="fu"><a href="https://rdrr.io/r/base/list.html" class="external-link">list</a></span><span class="op">(</span>side<span class="op">=</span><span class="fl">4</span>,  font<span class="op">=</span><span class="fl">2</span>, cex.axis<span class="op">=</span><span class="fl">0.75</span><span class="op">)</span>, fmt.key<span class="op">=</span><span class="st">"%.2f"</span>, </span>
<span>     polygon.key<span class="op">=</span><span class="cn">NULL</span>, axis.key<span class="op">=</span><span class="cn">NULL</span>, spacing.key<span class="op">=</span><span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fl">3</span>,<span class="fl">2</span>,<span class="fl">2</span><span class="op">)</span><span class="op">)</span></span></code></pre></div>
<p><img src="plot.matrix_files/figure-html/unnamed-chunk-19-1.png" width="384"></p>
</div>
<div class="section level4">
<h4 id="change-the-output-format-of-the-key-labels">Change the output format of the key labels<a class="anchor" aria-label="anchor" href="#change-the-output-format-of-the-key-labels"></a>
</h4>
<p>You can either use <code>digits</code> which changes the output
format for all text. If you just want to change the output format for
the key labels use <code>fmt.key</code>, e.g. </p>
<div class="sourceCode" id="cb31"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu"><a href="https://rdrr.io/r/graphics/par.html" class="external-link">par</a></span><span class="op">(</span>mar<span class="op">=</span><span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fl">5.1</span>, <span class="fl">4.1</span>, <span class="fl">4.1</span>, <span class="fl">4.1</span><span class="op">)</span><span class="op">)</span>   <span class="co"># adapt margins</span></span>
<span><span class="co"># no plus sign</span></span>
<span><span class="fu"><a href="../reference/plot.matrix.html">plot</a></span><span class="op">(</span><span class="va">x</span>, fmt.key<span class="op">=</span><span class="st">"%.3f"</span>, breaks<span class="op">=</span><span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fl">0</span>,<span class="fl">1</span><span class="op">)</span><span class="op">)</span></span></code></pre></div>
<p><img src="plot.matrix_files/figure-html/unnamed-chunk-20-1.png" width="384"></p>
<p>For details to the format string see <code>sprintf</code>, for
non-numeric matrices <code>%s</code> should be used.</p>
<p><strong><em>Warning: The format string is passed down the OS’s
sprintf function, and incorrect formats can cause the latter to crash
the R process. R does perform sanity checks on the format, but not all
possible user errors on all platforms have been tested, and some might
be terminal.</em></strong></p>
</div>
</div>
<div class="section level3">
<h3 id="modifying-the-row-and-column-axes">Modifying the row and column axes<a class="anchor" aria-label="anchor" href="#modifying-the-row-and-column-axes"></a>
</h3>
<p>As default the row axis is drawn as y-axis and the col axis is drawn
as x-axis with row and column indices. If the matrix has
<code>rownames(x)</code> or <code>colnames(x)</code> then they will
used. The same holds for the labels of the axes if
<code>names(dimnames(x))</code>is not empty.</p>
<div class="sourceCode" id="cb32"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu"><a href="https://rdrr.io/r/graphics/par.html" class="external-link">par</a></span><span class="op">(</span>mar<span class="op">=</span><span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fl">5.1</span>, <span class="fl">4.1</span>, <span class="fl">4.1</span>, <span class="fl">4.1</span><span class="op">)</span><span class="op">)</span>   <span class="co"># adapt margins</span></span>
<span><span class="fu"><a href="../reference/plot.matrix.html">plot</a></span><span class="op">(</span><span class="va">x</span>, xlab<span class="op">=</span><span class="st">"my x label"</span>, ylab<span class="op">=</span><span class="st">"my y label"</span><span class="op">)</span></span></code></pre></div>
<p><img src="plot.matrix_files/figure-html/unnamed-chunk-21-1.png" width="384"></p>
<div class="sourceCode" id="cb33"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="co"># The HairEyeColor has its own names</span></span>
<span><span class="va">tab</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/apply.html" class="external-link">apply</a></span><span class="op">(</span><span class="va">HairEyeColor</span>,<span class="fl">1</span><span class="op">:</span><span class="fl">2</span>, <span class="va">sum</span><span class="op">)</span></span>
<span><span class="fu"><a href="../reference/plot.matrix.html">plot</a></span><span class="op">(</span><span class="va">tab</span><span class="op">)</span></span></code></pre></div>
<p><img src="plot.matrix_files/figure-html/unnamed-chunk-21-2.png" width="384"></p>
<p>For moving, e.g. the column axis to the top, use</p>
<div class="sourceCode" id="cb34"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu"><a href="https://rdrr.io/r/graphics/par.html" class="external-link">par</a></span><span class="op">(</span>mar<span class="op">=</span><span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fl">5.1</span>, <span class="fl">4.1</span>, <span class="fl">5.1</span>, <span class="fl">4.1</span><span class="op">)</span><span class="op">)</span>   <span class="co"># adapt margins</span></span>
<span><span class="fu"><a href="../reference/plot.matrix.html">plot</a></span><span class="op">(</span><span class="va">x</span>, axis.col<span class="op">=</span><span class="fu"><a href="https://rdrr.io/r/base/list.html" class="external-link">list</a></span><span class="op">(</span>side<span class="op">=</span><span class="fl">3</span>, cex.axis<span class="op">=</span><span class="fl">0.7</span><span class="op">)</span>, axis.row<span class="op">=</span><span class="fu"><a href="https://rdrr.io/r/base/list.html" class="external-link">list</a></span><span class="op">(</span>cex.axis<span class="op">=</span><span class="fl">0.7</span><span class="op">)</span><span class="op">)</span></span></code></pre></div>
<p><img src="plot.matrix_files/figure-html/unnamed-chunk-22-1.png" width="384"></p>
<div class="sourceCode" id="cb35"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="co"># or alternatively set cex.axis for all axes and use abbreviated positioning</span></span>
<span><span class="fu"><a href="../reference/plot.matrix.html">plot</a></span><span class="op">(</span><span class="va">x</span>, axis.col<span class="op">=</span><span class="fl">3</span>, cex.axis<span class="op">=</span><span class="fl">0.7</span><span class="op">)</span></span></code></pre></div>
<p><img src="plot.matrix_files/figure-html/unnamed-chunk-22-2.png" width="384"></p>
<p>For not drawing any axes use</p>
<div class="sourceCode" id="cb36"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu"><a href="https://rdrr.io/r/graphics/par.html" class="external-link">par</a></span><span class="op">(</span>mar<span class="op">=</span><span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fl">5.1</span>, <span class="fl">4.1</span>, <span class="fl">4.1</span>, <span class="fl">4.1</span><span class="op">)</span><span class="op">)</span>   <span class="co"># adapt margins</span></span>
<span><span class="fu"><a href="../reference/plot.matrix.html">plot</a></span><span class="op">(</span><span class="va">x</span>, axis.col<span class="op">=</span><span class="cn">NULL</span>, axis.row<span class="op">=</span><span class="cn">NULL</span>, xlab<span class="op">=</span><span class="st">''</span>, ylab<span class="op">=</span><span class="st">''</span><span class="op">)</span></span></code></pre></div>
<p><img src="plot.matrix_files/figure-html/unnamed-chunk-23-1.png" width="384"></p>
</div>
<div class="section level3">
<h3 id="show-matrix-entries">Show matrix entries<a class="anchor" aria-label="anchor" href="#show-matrix-entries"></a>
</h3>
<p>You can either use <code>digits</code> which changes the output
format for all text. If you just want to change the output format for
the key labels use <code>fmt.cell</code>, e.g. </p>
<div class="sourceCode" id="cb37"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu"><a href="https://rdrr.io/r/graphics/par.html" class="external-link">par</a></span><span class="op">(</span>mar<span class="op">=</span><span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fl">5.1</span>, <span class="fl">4.1</span>, <span class="fl">4.1</span>, <span class="fl">4.1</span><span class="op">)</span><span class="op">)</span>   <span class="co"># adapt margins</span></span>
<span><span class="co"># change all text output</span></span>
<span><span class="fu"><a href="../reference/plot.matrix.html">plot</a></span><span class="op">(</span><span class="va">x</span>, digits<span class="op">=</span><span class="fl">4</span>, text.cell<span class="op">=</span><span class="fu"><a href="https://rdrr.io/r/base/list.html" class="external-link">list</a></span><span class="op">(</span>cex<span class="op">=</span><span class="fl">0.5</span><span class="op">)</span><span class="op">)</span></span></code></pre></div>
<p><img src="plot.matrix_files/figure-html/unnamed-chunk-24-1.png" width="384"></p>
<div class="sourceCode" id="cb38"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="co"># of alternatively use the global parameter cex</span></span>
<span><span class="fu"><a href="../reference/plot.matrix.html">plot</a></span><span class="op">(</span><span class="va">x</span>, digits<span class="op">=</span><span class="fl">4</span>, cex<span class="op">=</span><span class="fl">0.5</span><span class="op">)</span></span></code></pre></div>
<p><img src="plot.matrix_files/figure-html/unnamed-chunk-24-2.png" width="384"></p>
<div class="sourceCode" id="cb39"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="co"># change just matrix entries (no plus sign)</span></span>
<span><span class="fu"><a href="../reference/plot.matrix.html">plot</a></span><span class="op">(</span><span class="va">x</span>, fmt.cell<span class="op">=</span><span class="st">'%.2f'</span><span class="op">)</span></span></code></pre></div>
<p><img src="plot.matrix_files/figure-html/unnamed-chunk-24-3.png" width="384"></p>
</div>
<div class="section level3">
<h3 id="na-handling">
<code>NA</code> handling<a class="anchor" aria-label="anchor" href="#na-handling"></a>
</h3>
<p>Usually <code>NA</code> values in a matrix are drawn as white boxes
which determined by the value of the <code>na.col</code> parameter
(default: white) and if the matrix entries shown by `NA</p>
<div class="sourceCode" id="cb40"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">x</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/matrix.html" class="external-link">matrix</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="cn">NA</span>, <span class="fl">1</span>, <span class="fl">2</span>, <span class="fl">3</span><span class="op">)</span>, ncol<span class="op">=</span><span class="fl">2</span><span class="op">)</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/graphics/par.html" class="external-link">par</a></span><span class="op">(</span>mar<span class="op">=</span><span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fl">5.1</span>, <span class="fl">4.1</span>, <span class="fl">4.1</span>, <span class="fl">4.1</span><span class="op">)</span><span class="op">)</span>   <span class="co"># adapt margins</span></span>
<span><span class="fu"><a href="../reference/plot.matrix.html">plot</a></span><span class="op">(</span><span class="va">x</span>, na.col<span class="op">=</span><span class="st">'black'</span>, fmt.cell<span class="op">=</span><span class="st">'%.0f'</span><span class="op">)</span></span></code></pre></div>
<p><img src="plot.matrix_files/figure-html/unnamed-chunk-25-1.png" width="384"></p>
<p>You may enforce with <code>na.print</code> no printing of
<code>NA</code>s or using a replacement text</p>
<div class="sourceCode" id="cb41"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">x</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/matrix.html" class="external-link">matrix</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="cn">NA</span>, <span class="fl">1</span>, <span class="fl">2</span>, <span class="fl">3</span><span class="op">)</span>, ncol<span class="op">=</span><span class="fl">2</span><span class="op">)</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/graphics/par.html" class="external-link">par</a></span><span class="op">(</span>mar<span class="op">=</span><span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fl">5.1</span>, <span class="fl">4.1</span>, <span class="fl">4.1</span>, <span class="fl">4.1</span><span class="op">)</span><span class="op">)</span>   <span class="co"># adapt margins</span></span>
<span><span class="fu"><a href="../reference/plot.matrix.html">plot</a></span><span class="op">(</span><span class="va">x</span>, na.col<span class="op">=</span><span class="st">'black'</span>, fmt.cell<span class="op">=</span><span class="st">'%.0f'</span>, na.print<span class="op">=</span><span class="cn">FALSE</span><span class="op">)</span></span></code></pre></div>
<p><img src="plot.matrix_files/figure-html/unnamed-chunk-26-1.png" width="384"></p>
<div class="sourceCode" id="cb42"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu"><a href="../reference/plot.matrix.html">plot</a></span><span class="op">(</span><span class="va">x</span>, na.col<span class="op">=</span><span class="st">'black'</span>, fmt.cell<span class="op">=</span><span class="st">'%.0f'</span>, na.print<span class="op">=</span><span class="st">'Missing'</span><span class="op">)</span></span></code></pre></div>
<p><img src="plot.matrix_files/figure-html/unnamed-chunk-26-2.png" width="384"></p>
<p>With <code>na.cell</code> you suppress printing of matrix entries at
all</p>
<div class="sourceCode" id="cb43"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">x</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/matrix.html" class="external-link">matrix</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="cn">NA</span>, <span class="fl">1</span>, <span class="fl">2</span>, <span class="fl">3</span><span class="op">)</span>, ncol<span class="op">=</span><span class="fl">2</span><span class="op">)</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/graphics/par.html" class="external-link">par</a></span><span class="op">(</span>mar<span class="op">=</span><span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fl">5.1</span>, <span class="fl">4.1</span>, <span class="fl">4.1</span>, <span class="fl">4.1</span><span class="op">)</span><span class="op">)</span>   <span class="co"># adapt margins</span></span>
<span><span class="fu"><a href="../reference/plot.matrix.html">plot</a></span><span class="op">(</span><span class="va">x</span>, fmt.cell<span class="op">=</span><span class="st">'%.0f'</span>, na.cell<span class="op">=</span><span class="cn">FALSE</span><span class="op">)</span></span></code></pre></div>
<p><img src="plot.matrix_files/figure-html/unnamed-chunk-27-1.png" width="384"></p>
</div>
<div class="section level3">
<h3 id="automatic-text-color-adjustment">Automatic text color adjustment<a class="anchor" aria-label="anchor" href="#automatic-text-color-adjustment"></a>
</h3>
<p>It may happen that the text color and cell background color are <a href="https://en.wikipedia.org/wiki/Color_difference#Euclidean" class="external-link">too
near</a> which means you can not read the text anymore in a cell</p>
<div class="sourceCode" id="cb44"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu"><a href="https://rdrr.io/r/graphics/par.html" class="external-link">par</a></span><span class="op">(</span>mar<span class="op">=</span><span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fl">5.1</span>, <span class="fl">4.1</span>, <span class="fl">4.1</span>, <span class="fl">4.1</span><span class="op">)</span><span class="op">)</span>   <span class="co"># adapt margins</span></span>
<span><span class="co"># Never replace text color by black or white</span></span>
<span><span class="fu"><a href="../reference/plot.matrix.html">plot</a></span><span class="op">(</span><span class="va">x</span>, digits<span class="op">=</span><span class="fl">2</span>, text.cell<span class="op">=</span><span class="fu"><a href="https://rdrr.io/r/base/list.html" class="external-link">list</a></span><span class="op">(</span>col<span class="op">=</span><span class="st">"yellow"</span>, cex<span class="op">=</span><span class="fl">0.75</span><span class="op">)</span>, max.col<span class="op">=</span><span class="op">-</span><span class="fl">1</span><span class="op">)</span> </span></code></pre></div>
<p><img src="plot.matrix_files/figure-html/unnamed-chunk-28-1.png" width="384"></p>
<p>By default the text color is replaced by black or white (which is <a href="https://en.wikipedia.org/wiki/Color_difference#Euclidean" class="external-link">further
away</a>)</p>
<div class="sourceCode" id="cb45"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu"><a href="https://rdrr.io/r/graphics/par.html" class="external-link">par</a></span><span class="op">(</span>mar<span class="op">=</span><span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fl">5.1</span>, <span class="fl">4.1</span>, <span class="fl">4.1</span>, <span class="fl">4.1</span><span class="op">)</span><span class="op">)</span>   <span class="co"># adapt margins</span></span>
<span><span class="fu"><a href="../reference/plot.matrix.html">plot</a></span><span class="op">(</span><span class="va">x</span>, digits<span class="op">=</span><span class="fl">2</span>, text.cell<span class="op">=</span><span class="fu"><a href="https://rdrr.io/r/base/list.html" class="external-link">list</a></span><span class="op">(</span>col<span class="op">=</span><span class="st">"yellow"</span>, cex<span class="op">=</span><span class="fl">0.75</span><span class="op">)</span><span class="op">)</span> </span></code></pre></div>
<p><img src="plot.matrix_files/figure-html/unnamed-chunk-29-1.png" width="384"></p>
<p>Just replace text color if colors are nearer then the default
<code>max.col=70</code></p>
<div class="sourceCode" id="cb46"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu"><a href="https://rdrr.io/r/graphics/par.html" class="external-link">par</a></span><span class="op">(</span>mar<span class="op">=</span><span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fl">5.1</span>, <span class="fl">4.1</span>, <span class="fl">4.1</span>, <span class="fl">4.1</span><span class="op">)</span><span class="op">)</span>   <span class="co"># adapt margins</span></span>
<span><span class="co"># In fewer cells the text color will be replaced by black</span></span>
<span><span class="fu"><a href="../reference/plot.matrix.html">plot</a></span><span class="op">(</span><span class="va">x</span>, digits<span class="op">=</span><span class="fl">2</span>, text.cell<span class="op">=</span><span class="fu"><a href="https://rdrr.io/r/base/list.html" class="external-link">list</a></span><span class="op">(</span>col<span class="op">=</span><span class="st">"yellow"</span>, cex<span class="op">=</span><span class="fl">0.75</span><span class="op">)</span>, max.col<span class="op">=</span><span class="fl">35</span><span class="op">)</span> </span></code></pre></div>
<p><img src="plot.matrix_files/figure-html/unnamed-chunk-30-1.png" width="384"></p>
<p>or farer away then the default</p>
<div class="sourceCode" id="cb47"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu"><a href="https://rdrr.io/r/graphics/par.html" class="external-link">par</a></span><span class="op">(</span>mar<span class="op">=</span><span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fl">5.1</span>, <span class="fl">4.1</span>, <span class="fl">4.1</span>, <span class="fl">4.1</span><span class="op">)</span><span class="op">)</span>   <span class="co"># adapt margins</span></span>
<span><span class="co"># In more cells the text color will be replaced by black</span></span>
<span><span class="fu"><a href="../reference/plot.matrix.html">plot</a></span><span class="op">(</span><span class="va">x</span>, digits<span class="op">=</span><span class="fl">2</span>, text.cell<span class="op">=</span><span class="fu"><a href="https://rdrr.io/r/base/list.html" class="external-link">list</a></span><span class="op">(</span>col<span class="op">=</span><span class="st">"yellow"</span>, cex<span class="op">=</span><span class="fl">0.75</span><span class="op">)</span>, max.col<span class="op">=</span><span class="fl">140</span><span class="op">)</span> </span></code></pre></div>
<p><img src="plot.matrix_files/figure-html/unnamed-chunk-31-1.png" width="384"></p>
<p>Of course, the best solution is to choose a good color scheme and a
good text color ;)</p>
</div>
<div class="section level3">
<h3 id="information-about-drawn-elements">Information about drawn elements<a class="anchor" aria-label="anchor" href="#information-about-drawn-elements"></a>
</h3>
<p>The <code>plot</code> command returns invisibly a list of the
elements drawn, a bit like <code>hist</code>. A <code>NULL</code> entry
means the element has not been drawn. The data may be useful for adding
own elements in the graphic.</p>
<div class="sourceCode" id="cb48"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="co"># numeric matrix</span></span>
<span><span class="va">x</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/matrix.html" class="external-link">matrix</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/stats/Uniform.html" class="external-link">runif</a></span><span class="op">(</span><span class="fl">35</span><span class="op">)</span>, ncol<span class="op">=</span><span class="fl">5</span><span class="op">)</span> <span class="co"># create a numeric matrix object</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/graphics/par.html" class="external-link">par</a></span><span class="op">(</span>mar<span class="op">=</span><span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fl">5.1</span>, <span class="fl">4.1</span>, <span class="fl">4.1</span>, <span class="fl">4.1</span><span class="op">)</span><span class="op">)</span> <span class="co"># adapt margins</span></span>
<span><span class="va">res</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/plot.matrix.html">plot</a></span><span class="op">(</span><span class="va">x</span><span class="op">)</span></span></code></pre></div>
<p><img src="plot.matrix_files/figure-html/unnamed-chunk-32-1.png" width="384"></p>
<p>Available are the parameters for</p>
<ul>
<li>
<code>cell.polygon</code>, <code>cell.text</code>: the polygon and
the text used to draw a matrix element,</li>
<li>
<code>key.polygon</code>, <code>key.axis</code>: the polygon and the
axis used to draw a key element, and</li>
<li>
<code>plot</code>, <code>axis.col</code>, <code>axis.row</code>: the
basic plot and the axes drawn.</li>
</ul>
<div class="sourceCode" id="cb49"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="co">#####</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/base/names.html" class="external-link">names</a></span><span class="op">(</span><span class="va">res</span><span class="op">)</span></span>
<span><span class="co">#&gt; [1] "plot"         "cell.polygon" "cell.text"    "axis.col"     "axis.row"    </span></span>
<span><span class="co">#&gt; [6] "key.axis"     "key.polygon"</span></span>
<span><span class="co"># parameters of polygon which was used to draw x[3,4]</span></span>
<span><span class="va">res</span><span class="op">$</span><span class="va">cell.polygon</span><span class="op">[[</span><span class="fl">3</span>,<span class="fl">4</span><span class="op">]</span><span class="op">]</span></span>
<span><span class="co">#&gt; $y</span></span>
<span><span class="co">#&gt; [1] 4.5 5.5 5.5 4.5</span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt; $x</span></span>
<span><span class="co">#&gt; [1] 3.5 3.5 4.5 4.5</span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt; $col</span></span>
<span><span class="co">#&gt; [1] "#FF0000"</span></span>
<span><span class="co">#####</span></span>
<span><span class="co"># parameters of text which was used for x[3,4]</span></span>
<span><span class="va">res</span><span class="op">$</span><span class="va">cell.text</span><span class="op">[[</span><span class="fl">3</span>,<span class="fl">4</span><span class="op">]</span><span class="op">]</span>  <span class="co"># NULL since no text was drawn</span></span>
<span><span class="co">#&gt; NULL</span></span>
<span><span class="co">#####</span></span>
<span><span class="co"># parameters of polygon which was used to draw the second key element</span></span>
<span><span class="va">res</span><span class="op">$</span><span class="va">key.polygon</span><span class="op">[[</span><span class="fl">2</span><span class="op">]</span><span class="op">]</span>  </span>
<span><span class="co">#&gt; $x</span></span>
<span><span class="co">#&gt; [1] 6.0 6.0 6.5 6.5</span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt; $y</span></span>
<span><span class="co">#&gt; [1] 2.2 3.4 3.4 2.2</span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt; $col</span></span>
<span><span class="co">#&gt; [1] "#FF5500"</span></span></code></pre></div>
<div class="section level5">
<h5 id="example-add-shading-lines">Example: Add shading lines<a class="anchor" aria-label="anchor" href="#example-add-shading-lines"></a>
</h5>
<div class="sourceCode" id="cb50"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">x</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/matrix.html" class="external-link">matrix</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/stats/Uniform.html" class="external-link">runif</a></span><span class="op">(</span><span class="fl">35</span><span class="op">)</span>, ncol<span class="op">=</span><span class="fl">5</span><span class="op">)</span> <span class="co"># create a numeric matrix object</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/graphics/par.html" class="external-link">par</a></span><span class="op">(</span>mar<span class="op">=</span><span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fl">5.1</span>, <span class="fl">4.1</span>, <span class="fl">4.1</span>, <span class="fl">4.1</span><span class="op">)</span><span class="op">)</span> <span class="co"># adapt margins</span></span>
<span><span class="va">res</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/plot.matrix.html">plot</a></span><span class="op">(</span><span class="va">x</span><span class="op">)</span></span>
<span></span>
<span><span class="kw">for</span> <span class="op">(</span><span class="va">i</span> <span class="kw">in</span> <span class="fl">1</span><span class="op">:</span><span class="fu"><a href="https://rdrr.io/r/base/length.html" class="external-link">length</a></span><span class="op">(</span><span class="va">res</span><span class="op">$</span><span class="va">cell.polygon</span><span class="op">)</span><span class="op">)</span> <span class="op">{</span></span>
<span>  <span class="va">args</span> <span class="op">&lt;-</span> <span class="va">res</span><span class="op">$</span><span class="va">cell.polygon</span><span class="op">[[</span><span class="va">i</span><span class="op">]</span><span class="op">]</span></span>
<span>  <span class="va">args</span><span class="op">$</span><span class="va">col</span>     <span class="op">&lt;-</span> <span class="cn">NA</span>       <span class="co"># use no color</span></span>
<span>  <span class="va">args</span><span class="op">$</span><span class="va">density</span> <span class="op">&lt;-</span> <span class="fl">20</span><span class="op">*</span><span class="va">x</span><span class="op">[</span><span class="va">i</span><span class="op">]</span>  <span class="co"># density depends on matrix entries</span></span>
<span>  <span class="va">args</span><span class="op">$</span><span class="va">angle</span>   <span class="op">&lt;-</span> <span class="fl">45</span>       </span>
<span>  <span class="fu"><a href="https://rdrr.io/r/base/do.call.html" class="external-link">do.call</a></span><span class="op">(</span><span class="st">"polygon"</span>, <span class="va">args</span><span class="op">)</span></span>
<span><span class="op">}</span></span></code></pre></div>
<p><img src="plot.matrix_files/figure-html/unnamed-chunk-34-1.png" width="700"></p>
</div>
<div class="section level5">
<h5 id="example-adding-images">Example: Adding images<a class="anchor" aria-label="anchor" href="#example-adding-images"></a>
</h5>
<p>Please note that the PNGs have a transparent background. It depends
on the graphic device how the transparency is taken into account.</p>
<div class="sourceCode" id="cb51"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">x</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/matrix.html" class="external-link">matrix</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/stats/Uniform.html" class="external-link">runif</a></span><span class="op">(</span><span class="fl">35</span><span class="op">)</span>, ncol<span class="op">=</span><span class="fl">5</span><span class="op">)</span> <span class="co"># create a numeric matrix object</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/graphics/par.html" class="external-link">par</a></span><span class="op">(</span>mar<span class="op">=</span><span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fl">5.1</span>, <span class="fl">4.1</span>, <span class="fl">4.1</span>, <span class="fl">4.1</span><span class="op">)</span><span class="op">)</span> <span class="co"># adapt margins</span></span>
<span><span class="va">res</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/plot.matrix.html">plot</a></span><span class="op">(</span><span class="va">x</span><span class="op">)</span></span>
<span><span class="co">#</span></span>
<span><span class="kw"><a href="https://rdrr.io/r/base/library.html" class="external-link">library</a></span><span class="op">(</span><span class="st"><a href="http://www.rforge.net/png/" class="external-link">"png"</a></span><span class="op">)</span></span>
<span><span class="co"># PNGs are created from wikimedia commons images, CC0 by C. Koltzenburg </span></span>
<span><span class="co"># https://commons.wikimedia.org/wiki/File:C.Koltzenburg_-_smiley-yes.xcf</span></span>
<span><span class="co"># https://commons.wikimedia.org/wiki/File:C.Koltzenburg_-_smiley_no.xcf</span></span>
<span><span class="va">happy</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/pkg/png/man/readPNG.html" class="external-link">readPNG</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/system.file.html" class="external-link">system.file</a></span><span class="op">(</span><span class="st">'png'</span>, <span class="st">'happy.png'</span>, package<span class="op">=</span><span class="st">"plot.matrix"</span><span class="op">)</span><span class="op">)</span></span>
<span><span class="va">sad</span>   <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/pkg/png/man/readPNG.html" class="external-link">readPNG</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/system.file.html" class="external-link">system.file</a></span><span class="op">(</span><span class="st">'png'</span>, <span class="st">'sad.png'</span>, package<span class="op">=</span><span class="st">"plot.matrix"</span><span class="op">)</span><span class="op">)</span></span>
<span></span>
<span><span class="kw">for</span> <span class="op">(</span><span class="va">i</span> <span class="kw">in</span> <span class="fl">1</span><span class="op">:</span><span class="fu"><a href="https://rdrr.io/r/base/length.html" class="external-link">length</a></span><span class="op">(</span><span class="va">res</span><span class="op">$</span><span class="va">cell.polygon</span><span class="op">)</span><span class="op">)</span> <span class="op">{</span></span>
<span>  <span class="va">args</span> <span class="op">&lt;-</span> <span class="va">res</span><span class="op">$</span><span class="va">cell.polygon</span><span class="op">[[</span><span class="va">i</span><span class="op">]</span><span class="op">]</span></span>
<span>  <span class="kw">if</span> <span class="op">(</span><span class="va">x</span><span class="op">[</span><span class="va">i</span><span class="op">]</span><span class="op">&gt;</span><span class="fl">0.5</span><span class="op">)</span> <span class="op">{</span></span>
<span>    <span class="fu"><a href="https://rdrr.io/r/graphics/rasterImage.html" class="external-link">rasterImage</a></span><span class="op">(</span><span class="va">happy</span>, <span class="va">args</span><span class="op">$</span><span class="va">x</span><span class="op">[</span><span class="fl">1</span><span class="op">]</span><span class="op">+</span><span class="fl">0.1</span>, <span class="va">args</span><span class="op">$</span><span class="va">y</span><span class="op">[</span><span class="fl">1</span><span class="op">]</span><span class="op">+</span><span class="fl">0.1</span>, <span class="va">args</span><span class="op">$</span><span class="va">x</span><span class="op">[</span><span class="fl">3</span><span class="op">]</span><span class="op">-</span><span class="fl">0.1</span>, <span class="va">args</span><span class="op">$</span><span class="va">y</span><span class="op">[</span><span class="fl">2</span><span class="op">]</span><span class="op">-</span><span class="fl">0.1</span><span class="op">)</span></span>
<span>  <span class="op">}</span> <span class="kw">else</span> <span class="op">{</span></span>
<span>    <span class="fu"><a href="https://rdrr.io/r/graphics/rasterImage.html" class="external-link">rasterImage</a></span><span class="op">(</span><span class="va">sad</span>, <span class="va">args</span><span class="op">$</span><span class="va">x</span><span class="op">[</span><span class="fl">1</span><span class="op">]</span><span class="op">+</span><span class="fl">0.1</span>, <span class="va">args</span><span class="op">$</span><span class="va">y</span><span class="op">[</span><span class="fl">1</span><span class="op">]</span><span class="op">+</span><span class="fl">0.1</span>, <span class="va">args</span><span class="op">$</span><span class="va">x</span><span class="op">[</span><span class="fl">3</span><span class="op">]</span><span class="op">-</span><span class="fl">0.1</span>, <span class="va">args</span><span class="op">$</span><span class="va">y</span><span class="op">[</span><span class="fl">2</span><span class="op">]</span><span class="op">-</span><span class="fl">0.1</span><span class="op">)</span></span>
<span>  <span class="op">}</span></span>
<span><span class="op">}</span></span></code></pre></div>
<p><img src="plot.matrix_files/figure-html/unnamed-chunk-35-1.png" width="700"></p>
</div>
</div>
</div>
<div class="section level2">
<h2 id="plotting-special-matrices">Plotting special matrices<a class="anchor" aria-label="anchor" href="#plotting-special-matrices"></a>
</h2>
<p>For some special matrices we have special plot routines:</p>
<ul>
<li>loadings of a factor analysis or principal component analysis:
<code>plot.loadings</code>
</li>
<li>correlations: <code>plot.cor</code>
</li>
<li>associations: <code>plot.assoc</code>
</li>
<li>p values: <code>plot.pvalue</code>
</li>
</ul>
<p>All plot routines support the parameters</p>
<ul>
<li>
<code>gray</code> and <code>grey</code> for gray scale image</li>
<li>
<code>reorder</code> for reordering rows (default:
<code>reorder=TRUE</code>)</li>
</ul>
<p>Note that matrix columns are only reordered if the column names are
identical to the row names.</p>
<div class="section level3">
<h3 id="loadings-matrix">Loadings matrix<a class="anchor" aria-label="anchor" href="#loadings-matrix"></a>
</h3>
<p>In factor or principal component analysis you may want to view the
loadings matrix. The S3 function <code>plot.loadings</code> allows to
create a heatmap with loadings. It differs from plotting a matrix by</p>
<ul>
<li>the color key ranges from -1 to 1,</li>
<li>the breaks are set to
<code>c(-sqrt(c(1, 0.75, 0.5, 0.25, 0.16)), 0, sqrt(c(1, 0.75, 0.5, 0.25, 0.16)))</code>,</li>
<li>the matrix rows, corresponding to the variables, are reordered
(according to the breaks),</li>
<li>the matrix entries are printed with two digits after the comma.</li>
</ul>
<p>A typical threshold in factor analysis is an absolute loading greater
equal 0.5; thus a factor “explains” 25% of the variance of a variable.
Further thresholds are selected such that they explain 50% and 75% of
the variable variance. Sometimes it might be useful to check whether
there are loadings a little bit under 0.5, therefore another threshold
of 0.4 is added.</p>
<p>All parameters described in <strong>Modifying a plot</strong> can be
used in <code>plot.loadings</code> as well.</p>
<div class="sourceCode" id="cb52"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="kw"><a href="https://rdrr.io/r/base/library.html" class="external-link">library</a></span><span class="op">(</span><span class="st"><a href="https://github.com/sigbertklinke/plot.matrix" class="external-link">'plot.matrix'</a></span><span class="op">)</span></span>
<span><span class="kw"><a href="https://rdrr.io/r/base/library.html" class="external-link">library</a></span><span class="op">(</span><span class="st"><a href="https://personality-project.org/r/psych/" class="external-link">'psych'</a></span><span class="op">)</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/utils/data.html" class="external-link">data</a></span><span class="op">(</span><span class="va">bfi.2</span><span class="op">)</span></span>
<span><span class="va">fa</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/pkg/psych/man/fa.html" class="external-link">fa</a></span><span class="op">(</span><span class="va">bfi.2</span>, <span class="fl">5</span>, rotate<span class="op">=</span><span class="st">"varimax"</span><span class="op">)</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/graphics/par.html" class="external-link">par</a></span><span class="op">(</span>mar<span class="op">=</span><span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fl">5.1</span>, <span class="fl">4.1</span>, <span class="fl">4.1</span>, <span class="fl">4.1</span><span class="op">)</span><span class="op">)</span> <span class="co"># adapt margins</span></span>
<span><span class="fu"><a href="../reference/plot.matrix.html">plot</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/stats/loadings.html" class="external-link">loadings</a></span><span class="op">(</span><span class="va">fa</span><span class="op">)</span>, cex<span class="op">=</span><span class="fl">0.5</span><span class="op">)</span></span></code></pre></div>
<p><img src="plot.matrix_files/figure-html/unnamed-chunk-36-1.png" width="480"></p>
<div class="section level4">
<h4 id="gray-scale">Gray scale<a class="anchor" aria-label="anchor" href="#gray-scale"></a>
</h4>
<p>For using a gray color scheme add <code>gray=TRUE</code>or
<code>grey=TRUE</code> to the call</p>
<div class="sourceCode" id="cb53"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="kw"><a href="https://rdrr.io/r/base/library.html" class="external-link">library</a></span><span class="op">(</span><span class="st"><a href="https://github.com/sigbertklinke/plot.matrix" class="external-link">'plot.matrix'</a></span><span class="op">)</span></span>
<span><span class="kw"><a href="https://rdrr.io/r/base/library.html" class="external-link">library</a></span><span class="op">(</span><span class="st"><a href="https://personality-project.org/r/psych/" class="external-link">'psych'</a></span><span class="op">)</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/utils/data.html" class="external-link">data</a></span><span class="op">(</span><span class="va">bfi.2</span><span class="op">)</span></span>
<span><span class="va">fa</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/pkg/psych/man/fa.html" class="external-link">fa</a></span><span class="op">(</span><span class="va">bfi.2</span>, <span class="fl">5</span>, rotate<span class="op">=</span><span class="st">"varimax"</span><span class="op">)</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/graphics/par.html" class="external-link">par</a></span><span class="op">(</span>mar<span class="op">=</span><span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fl">5.1</span>, <span class="fl">4.1</span>, <span class="fl">4.1</span>, <span class="fl">4.1</span><span class="op">)</span><span class="op">)</span> <span class="co"># adapt margins</span></span>
<span><span class="fu"><a href="../reference/plot.matrix.html">plot</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/stats/loadings.html" class="external-link">loadings</a></span><span class="op">(</span><span class="va">fa</span><span class="op">)</span>, cex<span class="op">=</span><span class="fl">0.5</span>, gray<span class="op">=</span><span class="cn">TRUE</span><span class="op">)</span></span></code></pre></div>
<p><img src="plot.matrix_files/figure-html/unnamed-chunk-37-1.png" width="480"></p>
</div>
<div class="section level4">
<h4 id="no-matrix-entries">No matrix entries<a class="anchor" aria-label="anchor" href="#no-matrix-entries"></a>
</h4>
<p>For not printing loading entries use the parameter
<code>digits</code>:</p>
<div class="sourceCode" id="cb54"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="kw"><a href="https://rdrr.io/r/base/library.html" class="external-link">library</a></span><span class="op">(</span><span class="st"><a href="https://github.com/sigbertklinke/plot.matrix" class="external-link">'plot.matrix'</a></span><span class="op">)</span></span>
<span><span class="kw"><a href="https://rdrr.io/r/base/library.html" class="external-link">library</a></span><span class="op">(</span><span class="st"><a href="https://personality-project.org/r/psych/" class="external-link">'psych'</a></span><span class="op">)</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/utils/data.html" class="external-link">data</a></span><span class="op">(</span><span class="va">bfi.2</span><span class="op">)</span></span>
<span><span class="va">fa</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/pkg/psych/man/fa.html" class="external-link">fa</a></span><span class="op">(</span><span class="va">bfi.2</span>, <span class="fl">5</span>, rotate<span class="op">=</span><span class="st">"varimax"</span><span class="op">)</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/graphics/par.html" class="external-link">par</a></span><span class="op">(</span>mar<span class="op">=</span><span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fl">5.1</span>, <span class="fl">4.1</span>, <span class="fl">4.1</span>, <span class="fl">4.1</span><span class="op">)</span><span class="op">)</span> <span class="co"># adapt margins</span></span>
<span><span class="fu"><a href="../reference/plot.matrix.html">plot</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/stats/loadings.html" class="external-link">loadings</a></span><span class="op">(</span><span class="va">fa</span><span class="op">)</span>, digits<span class="op">=</span><span class="cn">NA</span><span class="op">)</span></span></code></pre></div>
<p><img src="plot.matrix_files/figure-html/unnamed-chunk-38-1.png" width="480"></p>
</div>
<div class="section level4">
<h4 id="no-reordering-of-rows">No reordering of rows<a class="anchor" aria-label="anchor" href="#no-reordering-of-rows"></a>
</h4>
<p>For not reordering the variables use the parameter
<code>reorder</code>:</p>
<div class="sourceCode" id="cb55"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="kw"><a href="https://rdrr.io/r/base/library.html" class="external-link">library</a></span><span class="op">(</span><span class="st"><a href="https://github.com/sigbertklinke/plot.matrix" class="external-link">'plot.matrix'</a></span><span class="op">)</span></span>
<span><span class="kw"><a href="https://rdrr.io/r/base/library.html" class="external-link">library</a></span><span class="op">(</span><span class="st"><a href="https://personality-project.org/r/psych/" class="external-link">'psych'</a></span><span class="op">)</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/utils/data.html" class="external-link">data</a></span><span class="op">(</span><span class="va">bfi.2</span><span class="op">)</span></span>
<span><span class="va">fa</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/pkg/psych/man/fa.html" class="external-link">fa</a></span><span class="op">(</span><span class="va">bfi.2</span>, <span class="fl">5</span>, rotate<span class="op">=</span><span class="st">"varimax"</span><span class="op">)</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/graphics/par.html" class="external-link">par</a></span><span class="op">(</span>mar<span class="op">=</span><span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fl">5.1</span>, <span class="fl">4.1</span>, <span class="fl">4.1</span>, <span class="fl">4.1</span><span class="op">)</span><span class="op">)</span> <span class="co"># adapt margins</span></span>
<span><span class="fu"><a href="../reference/plot.matrix.html">plot</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/stats/loadings.html" class="external-link">loadings</a></span><span class="op">(</span><span class="va">fa</span><span class="op">)</span>, reorder<span class="op">=</span><span class="cn">FALSE</span>, cex<span class="op">=</span><span class="fl">0.5</span><span class="op">)</span></span></code></pre></div>
<p><img src="plot.matrix_files/figure-html/unnamed-chunk-39-1.png" width="480"></p>
</div>
</div>
<div class="section level3">
<h3 id="correlations-and-associations">Correlations and associations<a class="anchor" aria-label="anchor" href="#correlations-and-associations"></a>
</h3>
<p>The S3 function <code>plot.cor</code> and <code>plot.assoc</code>
allow to create a heatmap with the coefficients. It differs from
plotting a matrix by</p>
<ul>
<li>the color key ranges from -1 to 1 for correlations and 0 to 1 for
associations,</li>
<li>the breaks are set to reflect the effect sizes given by Cohen</li>
<li>the matrix rows, corresponding to the variables, are reordered using
<code>dist</code> and <code>hclust</code> with the defaults on the
rows,</li>
<li>the matrix entries are printed with two digits after the comma.</li>
</ul>
<p>All parameters described in <strong>Modifying a plot</strong> can be
used in <code>plot.assoc</code> or <code>plot.cor</code> as well.</p>
<div class="sourceCode" id="cb56"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="kw"><a href="https://rdrr.io/r/base/library.html" class="external-link">library</a></span><span class="op">(</span><span class="st"><a href="https://github.com/sigbertklinke/plot.matrix" class="external-link">'plot.matrix'</a></span><span class="op">)</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/utils/data.html" class="external-link">data</a></span><span class="op">(</span><span class="va">Titanic.cramer</span><span class="op">)</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/graphics/par.html" class="external-link">par</a></span><span class="op">(</span>mar<span class="op">=</span><span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fl">5.1</span>, <span class="fl">4.1</span>, <span class="fl">4.1</span>, <span class="fl">4.1</span><span class="op">)</span><span class="op">)</span> <span class="co"># adapt margins</span></span>
<span><span class="fu"><a href="../reference/plot.matrix.html">plot</a></span><span class="op">(</span><span class="fu"><a href="../reference/as.cor.html">as.assoc</a></span><span class="op">(</span><span class="va">Titanic.cramer</span><span class="op">)</span><span class="op">)</span></span></code></pre></div>
<p><img src="plot.matrix_files/figure-html/unnamed-chunk-40-1.png" width="480"></p>
<div class="sourceCode" id="cb57"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="kw"><a href="https://rdrr.io/r/base/library.html" class="external-link">library</a></span><span class="op">(</span><span class="st"><a href="https://github.com/sigbertklinke/plot.matrix" class="external-link">'plot.matrix'</a></span><span class="op">)</span></span>
<span><span class="kw"><a href="https://rdrr.io/r/base/library.html" class="external-link">library</a></span><span class="op">(</span><span class="st">'datasets'</span><span class="op">)</span></span>
<span><span class="va">c</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/stats/cor.html" class="external-link">cor</a></span><span class="op">(</span><span class="va">airquality</span><span class="op">[</span>,<span class="fl">1</span><span class="op">:</span><span class="fl">4</span><span class="op">]</span>, use<span class="op">=</span><span class="st">"complete"</span><span class="op">)</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/graphics/par.html" class="external-link">par</a></span><span class="op">(</span>mar<span class="op">=</span><span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fl">5.1</span>, <span class="fl">4.1</span>, <span class="fl">4.1</span>, <span class="fl">4.1</span><span class="op">)</span><span class="op">)</span> <span class="co"># adapt margins</span></span>
<span><span class="fu"><a href="../reference/plot.matrix.html">plot</a></span><span class="op">(</span><span class="fu"><a href="../reference/as.cor.html">as.cor</a></span><span class="op">(</span><span class="va">c</span><span class="op">)</span><span class="op">)</span></span></code></pre></div>
<p><img src="plot.matrix_files/figure-html/unnamed-chunk-41-1.png" width="480"></p>
<div class="section level4">
<h4 id="gray-scale-1">Gray scale<a class="anchor" aria-label="anchor" href="#gray-scale-1"></a>
</h4>
<p>For using a gray color scheme add <code>gray=TRUE</code>or
<code>grey=TRUE</code> to the call</p>
<div class="sourceCode" id="cb58"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="kw"><a href="https://rdrr.io/r/base/library.html" class="external-link">library</a></span><span class="op">(</span><span class="st"><a href="https://github.com/sigbertklinke/plot.matrix" class="external-link">'plot.matrix'</a></span><span class="op">)</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/utils/data.html" class="external-link">data</a></span><span class="op">(</span><span class="va">Titanic.cramer</span><span class="op">)</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/graphics/par.html" class="external-link">par</a></span><span class="op">(</span>mar<span class="op">=</span><span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fl">5.1</span>, <span class="fl">4.1</span>, <span class="fl">4.1</span>, <span class="fl">4.1</span><span class="op">)</span><span class="op">)</span> <span class="co"># adapt margins</span></span>
<span><span class="fu"><a href="../reference/plot.matrix.html">plot</a></span><span class="op">(</span><span class="fu"><a href="../reference/as.cor.html">as.assoc</a></span><span class="op">(</span><span class="va">Titanic.cramer</span><span class="op">)</span>, gray<span class="op">=</span><span class="cn">TRUE</span><span class="op">)</span></span></code></pre></div>
<p><img src="plot.matrix_files/figure-html/unnamed-chunk-42-1.png" width="480"></p>
</div>
<div class="section level4">
<h4 id="no-matrix-entries-1">No matrix entries<a class="anchor" aria-label="anchor" href="#no-matrix-entries-1"></a>
</h4>
<p>For not printing loading entries use the parameter
<code>digits</code>:</p>
<div class="sourceCode" id="cb59"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="kw"><a href="https://rdrr.io/r/base/library.html" class="external-link">library</a></span><span class="op">(</span><span class="st"><a href="https://github.com/sigbertklinke/plot.matrix" class="external-link">'plot.matrix'</a></span><span class="op">)</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/utils/data.html" class="external-link">data</a></span><span class="op">(</span><span class="va">Titanic.cramer</span><span class="op">)</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/graphics/par.html" class="external-link">par</a></span><span class="op">(</span>mar<span class="op">=</span><span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fl">5.1</span>, <span class="fl">4.1</span>, <span class="fl">4.1</span>, <span class="fl">4.1</span><span class="op">)</span><span class="op">)</span> <span class="co"># adapt margins</span></span>
<span><span class="fu"><a href="../reference/plot.matrix.html">plot</a></span><span class="op">(</span><span class="fu"><a href="../reference/as.cor.html">as.assoc</a></span><span class="op">(</span><span class="va">Titanic.cramer</span><span class="op">)</span>, digits<span class="op">=</span><span class="cn">NA</span><span class="op">)</span></span></code></pre></div>
<p><img src="plot.matrix_files/figure-html/unnamed-chunk-43-1.png" width="480"></p>
</div>
<div class="section level4">
<h4 id="no-reordering-of-rows-1">No reordering of rows<a class="anchor" aria-label="anchor" href="#no-reordering-of-rows-1"></a>
</h4>
<p>For not reordering the variables use the parameter
<code>reorder</code>:</p>
<div class="sourceCode" id="cb60"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="kw"><a href="https://rdrr.io/r/base/library.html" class="external-link">library</a></span><span class="op">(</span><span class="st"><a href="https://github.com/sigbertklinke/plot.matrix" class="external-link">'plot.matrix'</a></span><span class="op">)</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/utils/data.html" class="external-link">data</a></span><span class="op">(</span><span class="va">Titanic.cramer</span><span class="op">)</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/graphics/par.html" class="external-link">par</a></span><span class="op">(</span>mar<span class="op">=</span><span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fl">5.1</span>, <span class="fl">4.1</span>, <span class="fl">4.1</span>, <span class="fl">4.1</span><span class="op">)</span><span class="op">)</span> <span class="co"># adapt margins</span></span>
<span><span class="fu"><a href="../reference/plot.matrix.html">plot</a></span><span class="op">(</span><span class="fu"><a href="../reference/as.cor.html">as.assoc</a></span><span class="op">(</span><span class="va">Titanic.cramer</span><span class="op">)</span>, reorder<span class="op">=</span><span class="cn">FALSE</span><span class="op">)</span></span></code></pre></div>
<p><img src="plot.matrix_files/figure-html/unnamed-chunk-44-1.png" width="480"></p>
</div>
</div>
<div class="section level3">
<h3 id="p-values">P values<a class="anchor" aria-label="anchor" href="#p-values"></a>
</h3>
<p>The S3 function <code>plot.pvalue</code> allows to create a heatmap
from a matrix of p values. It differs from plotting a matrix by</p>
<ul>
<li>the color key ranges from 0 to 1</li>
<li>the breaks are set to 0, 0.1, 0.05, 0.01, 0.001 and 1</li>
<li>the matrix rows, corresponding to the variables, are reordered using
<code>dist</code> and <code>hclust</code> with the defaults on the
rows,</li>
<li>the matrix entries are printed with three digits after the
comma.</li>
</ul>
<p>All parameters described in <strong>Modifying a plot</strong> can be
used in <code>plot.pvalue</code> as well.</p>
<div class="sourceCode" id="cb61"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="kw"><a href="https://rdrr.io/r/base/library.html" class="external-link">library</a></span><span class="op">(</span><span class="st"><a href="https://github.com/sigbertklinke/plot.matrix" class="external-link">'plot.matrix'</a></span><span class="op">)</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/utils/data.html" class="external-link">data</a></span><span class="op">(</span><span class="va">air.pvalue</span><span class="op">)</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/graphics/par.html" class="external-link">par</a></span><span class="op">(</span>mar<span class="op">=</span><span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fl">5.1</span>, <span class="fl">4.1</span>, <span class="fl">4.1</span>, <span class="fl">4.1</span><span class="op">)</span><span class="op">)</span> <span class="co"># adapt margins</span></span>
<span><span class="fu"><a href="../reference/plot.matrix.html">plot</a></span><span class="op">(</span><span class="fu"><a href="../reference/as.cor.html">as.pvalue</a></span><span class="op">(</span><span class="va">air.pvalue</span><span class="op">)</span><span class="op">)</span></span></code></pre></div>
<p><img src="plot.matrix_files/figure-html/unnamed-chunk-45-1.png" width="480"></p>
<div class="section level4">
<h4 id="gray-scale-2">Gray scale<a class="anchor" aria-label="anchor" href="#gray-scale-2"></a>
</h4>
<p>For using a gray color scheme add <code>gray=TRUE</code>or
<code>grey=TRUE</code> to the call</p>
<div class="sourceCode" id="cb62"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="kw"><a href="https://rdrr.io/r/base/library.html" class="external-link">library</a></span><span class="op">(</span><span class="st"><a href="https://github.com/sigbertklinke/plot.matrix" class="external-link">'plot.matrix'</a></span><span class="op">)</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/utils/data.html" class="external-link">data</a></span><span class="op">(</span><span class="va">air.pvalue</span><span class="op">)</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/graphics/par.html" class="external-link">par</a></span><span class="op">(</span>mar<span class="op">=</span><span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fl">5.1</span>, <span class="fl">4.1</span>, <span class="fl">4.1</span>, <span class="fl">4.1</span><span class="op">)</span><span class="op">)</span> <span class="co"># adapt margins</span></span>
<span><span class="fu"><a href="../reference/plot.matrix.html">plot</a></span><span class="op">(</span><span class="fu"><a href="../reference/as.cor.html">as.pvalue</a></span><span class="op">(</span><span class="va">air.pvalue</span><span class="op">)</span>, gray<span class="op">=</span><span class="cn">TRUE</span><span class="op">)</span></span></code></pre></div>
<p><img src="plot.matrix_files/figure-html/unnamed-chunk-46-1.png" width="480"></p>
</div>
<div class="section level4">
<h4 id="no-matrix-entries-2">No matrix entries<a class="anchor" aria-label="anchor" href="#no-matrix-entries-2"></a>
</h4>
<p>For not printing loading entries use the parameter
<code>digits</code>:</p>
<div class="sourceCode" id="cb63"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="kw"><a href="https://rdrr.io/r/base/library.html" class="external-link">library</a></span><span class="op">(</span><span class="st"><a href="https://github.com/sigbertklinke/plot.matrix" class="external-link">'plot.matrix'</a></span><span class="op">)</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/utils/data.html" class="external-link">data</a></span><span class="op">(</span><span class="va">air.pvalue</span><span class="op">)</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/graphics/par.html" class="external-link">par</a></span><span class="op">(</span>mar<span class="op">=</span><span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fl">5.1</span>, <span class="fl">4.1</span>, <span class="fl">4.1</span>, <span class="fl">4.1</span><span class="op">)</span><span class="op">)</span> <span class="co"># adapt margins</span></span>
<span><span class="fu"><a href="../reference/plot.matrix.html">plot</a></span><span class="op">(</span><span class="fu"><a href="../reference/as.cor.html">as.pvalue</a></span><span class="op">(</span><span class="va">air.pvalue</span><span class="op">)</span>, digits<span class="op">=</span><span class="cn">NA</span><span class="op">)</span></span></code></pre></div>
<p><img src="plot.matrix_files/figure-html/unnamed-chunk-47-1.png" width="480"></p>
</div>
<div class="section level4">
<h4 id="no-reordering-of-rows-2">No reordering of rows<a class="anchor" aria-label="anchor" href="#no-reordering-of-rows-2"></a>
</h4>
<p>For not reordering the variables use the parameter
<code>reorder</code>:</p>
<div class="sourceCode" id="cb64"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="kw"><a href="https://rdrr.io/r/base/library.html" class="external-link">library</a></span><span class="op">(</span><span class="st"><a href="https://github.com/sigbertklinke/plot.matrix" class="external-link">'plot.matrix'</a></span><span class="op">)</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/utils/data.html" class="external-link">data</a></span><span class="op">(</span><span class="va">air.pvalue</span><span class="op">)</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/graphics/par.html" class="external-link">par</a></span><span class="op">(</span>mar<span class="op">=</span><span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fl">5.1</span>, <span class="fl">4.1</span>, <span class="fl">4.1</span>, <span class="fl">4.1</span><span class="op">)</span><span class="op">)</span> <span class="co"># adapt margins</span></span>
<span><span class="fu"><a href="../reference/plot.matrix.html">plot</a></span><span class="op">(</span><span class="fu"><a href="../reference/as.cor.html">as.pvalue</a></span><span class="op">(</span><span class="va">air.pvalue</span><span class="op">)</span>, reorder<span class="op">=</span><span class="cn">FALSE</span><span class="op">)</span></span></code></pre></div>
<p><img src="plot.matrix_files/figure-html/unnamed-chunk-48-1.png" width="480"></p>
</div>
</div>
</div>
  </main><aside class="col-md-3"><nav id="toc"><h2>On this page</h2>
    </nav></aside>
</div>



    <footer><div class="pkgdown-footer-left">
  <p></p>
<p>Developed by Sigbert Klinke.</p>
</div>

<div class="pkgdown-footer-right">
  <p></p>
<p>Site built with <a href="https://pkgdown.r-lib.org/" class="external-link">pkgdown</a> 2.0.6.</p>
</div>

    </footer>
</div>

  

  

  </body>
</html>
